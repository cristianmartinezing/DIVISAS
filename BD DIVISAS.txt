
CREATE TABLE "DIVISAS"."AV_DIVISAS_EXT" 
   (	"AA_FECHA_TRAN" VARCHAR2(20 BYTE), 
	"AA_TIPO_DIVISA" NUMBER(9,0), 
	"AA_MONTO_DIVISAS" NUMBER(22,0), 
	"AA_DEC_MONTO_DIV" NUMBER(28,0), 
	"CURRENCY_CD" VARCHAR2(3 BYTE), 
	"AA_OFICINA_DIVISAS" NUMBER(3,0), 
	"AA_TIPO_DOC_SEG" VARCHAR2(3 BYTE), 
	"AA_NRO_DOCUMENTO" NUMBER(15,0), 
	"AA_TASA_DIVISAS" NUMBER(13,0), 
	"AA_DEC_TASA_DIV" NUMBER(5,0)
   ) 
   ORGANIZATION EXTERNAL 
    ( TYPE ORACLE_LOADER
      DEFAULT DIRECTORY "CRMCRM"
      ACCESS PARAMETERS
      ( RECORDS DELIMITED BY NEWLINE    NOBADFILE    NODISCARDFILE    NOLOGFILE    FIELDS    MISSING FIELD VALUES ARE NULL    (      AA_FECHA_TRAN POSITION (1:8),      AA_TIPO_DIVISA POSITION (9:9),      AA_MONTO_DIVISAS POSITION (10:21),      AA_DEC_MONTO_DIV  POSITION (22:25),      CURRENCY_CD POSITION (26:29),      AA_OFICINA_DIVISAS  POSITION (30:32),      AA_TIPO_DOC_SEG POSITION (33:35),      AA_NRO_DOCUMENTO POSITION (36:48),      AA_TASA_DIVISAS POSITION (49:60),      AA_DEC_TASA_DIV POSITION (61:64)) 
  )
      LOCATION
       ( "CRMCRM":'DIVISAS.TXT'
       )
    )
   REJECT LIMIT UNLIMITED ;
--------------------------------------------------------
--  DDL for Table PS_AA_DIV_MOV_PJ
--------------------------------------------------------

  CREATE TABLE "DIVISAS"."PS_AA_DIV_MOV_PJ" 
   (	"NRO_IDENTIDAD" NUMBER(20,0), 
	"TIPO_IDENTIDAD" CHAR(1 BYTE), 
	"SETID" VARCHAR2(5 BYTE), 
	"SEQ_NBR" NUMBER(15,0), 
	"AA_FECHA_TX" DATE, 
	"AA_COD_AUTORIZ" VARCHAR2(4 BYTE), 
	"AA_MONTO_OPR" NUMBER(19,2), 
	"CURRENCY_CD" VARCHAR2(3 BYTE), 
	"PARTICIPATION_PCT" NUMBER(8,2), 
	"AA_MONTO_TASA" NUMBER(19,2), 
	"AA_TIPO_DIVISA" VARCHAR2(1 BYTE), 
	"ROW_ADDED_DTTM" TIMESTAMP (6), 
	"ROW_ADDED_OPRID" VARCHAR2(30 BYTE), 
	"ROW_LASTMANT_DTTM" TIMESTAMP (6), 
	"ROW_LASTMANT_OPRID" VARCHAR2(30 BYTE), 
	"SYNCID" NUMBER(*,0), 
	"SYNCDTTM" TIMESTAMP (6), 
	"AV_OFICINA_ADI" VARCHAR2(6 BYTE), 
	"AA_ORIGEN" VARCHAR2(30 BYTE), 
	"AV_OFICINA_MOD" VARCHAR2(6 BYTE), 
	"AA_ORIGEN_MOD" VARCHAR2(30 BYTE)
   ) ;
--------------------------------------------------------
--  DDL for Table PS_AA_DIV_MOV_PN
--------------------------------------------------------

  CREATE TABLE "DIVISAS"."PS_AA_DIV_MOV_PN" 
   (	"NRO_IDENTIDAD" NUMBER(20,0), 
	"TIPO_IDENTIDAD" CHAR(1 BYTE), 
	"SEQ_NBR" NUMBER(15,0), 
	"AA_FECHA_TX" DATE, 
	"AA_COD_AUTORIZ" VARCHAR2(4 BYTE), 
	"AA_MONTO_OPR" NUMBER(19,2), 
	"CURRENCY_CD" VARCHAR2(3 BYTE), 
	"PARTICIPATION_PCT" NUMBER(8,2), 
	"AA_MONTO_TASA" NUMBER(19,2), 
	"AA_TIPO_DIVISA" VARCHAR2(1 BYTE)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 ROW STORE COMPRESS ADVANCED LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"   NO INMEMORY ;
--------------------------------------------------------
--  DDL for Table PS_AA_ENTFINAN_TBL
--------------------------------------------------------

  CREATE TABLE "DIVISAS"."PS_AA_ENTFINAN_TBL" 
   (	"AA_COD_ENTIDAD" VARCHAR2(5 BYTE), 
	"AA_ENTIDAD_FIN" VARCHAR2(60 BYTE)
   ) ;
--------------------------------------------------------
--  DDL for Table PS_AA_ENTI_OPRPJ
--------------------------------------------------------

  CREATE TABLE "DIVISAS"."PS_AA_ENTI_OPRPJ" 
   (	"NRO_IDENTIDAD" NUMBER(20,0), 
	"TIPO_IDENTIDAD" CHAR(1 BYTE), 
	"SETID" VARCHAR2(5 BYTE), 
	"AA_COD_ENTIDAD" VARCHAR2(5 BYTE), 
	"AA_SECUENCIA" NUMBER(*,0), 
	"ROW_ADDED_DTTM" TIMESTAMP (6), 
	"ROW_ADDED_OPRID" VARCHAR2(30 BYTE), 
	"ROW_LASTMANT_DTTM" TIMESTAMP (6), 
	"ROW_LASTMANT_OPRID" VARCHAR2(30 BYTE), 
	"SYNCID" NUMBER(*,0), 
	"SYNCDTTM" TIMESTAMP (6), 
	"AV_OFICINA_ADI" VARCHAR2(6 BYTE), 
	"AA_ORIGEN" VARCHAR2(30 BYTE), 
	"AV_OFICINA_MOD" VARCHAR2(6 BYTE), 
	"AA_ORIGEN_MOD" VARCHAR2(30 BYTE)
   ) ;

  CREATE TABLE "DIVISAS"."PS_AA_ENTI_OPRPN" 
   (	"NRO_IDENTIDAD" NUMBER(13,0), 
	"TIPO_IDENTIDAD" CHAR(1 BYTE), 
	"AA_COD_ENTIDAD" VARCHAR2(5 BYTE), 
	"AA_SECUENCIA" NUMBER(*,0), 
	"ROW_ADDED_DTTM" TIMESTAMP (6), 
	"ROW_ADDED_OPRID" VARCHAR2(30 BYTE), 
	"ROW_LASTMANT_DTTM" TIMESTAMP (6), 
	"ROW_LASTMANT_OPRID" VARCHAR2(30 BYTE), 
	"SYNCID" NUMBER(*,0), 
	"SYNCDTTM" TIMESTAMP (6), 
	"AV_OFICINA_ADI" VARCHAR2(6 BYTE), 
	"AA_ORIGEN" VARCHAR2(30 BYTE), 
	"AV_OFICINA_MOD" VARCHAR2(6 BYTE), 
	"AA_ORIGEN_MOD" VARCHAR2(30 BYTE)
   )  ;

  CREATE TABLE "DIVISAS"."PS_AA_PJ_OPR_INTDT" 
   (	"NRO_IDENTIDAD" NUMBER(20,0), 
	"TIPO_IDENTIDAD" CHAR(1 BYTE), 
	"SETID" VARCHAR2(5 BYTE), 
	"SEQ_NBR" NUMBER(15,0), 
	"AA_BANCO" VARCHAR2(50 BYTE), 
	"AA_CIUDAD_OPR" VARCHAR2(18 BYTE), 
	"CURRENCY_CD" VARCHAR2(3 BYTE), 
	"AA_NRO_CUENTA" VARCHAR2(20 BYTE), 
	"COUNTRY" VARCHAR2(3 BYTE), 
	"AA_TIPO_CUENTA" VARCHAR2(2 BYTE), 
	"AA_DIVISAS" VARCHAR2(1 BYTE), 
	"AA_IMPORTACION" VARCHAR2(1 BYTE), 
	"AA_EXPORTACION" VARCHAR2(1 BYTE), 
	"AA_INVERSION" VARCHAR2(1 BYTE), 
	"AA_GIROS" VARCHAR2(1 BYTE), 
	"AA_ENVIO_GIROS" VARCHAR2(1 BYTE), 
	"AA_SERVICIOS" VARCHAR2(1 BYTE), 
	"AA_PRESTAMOS" VARCHAR2(1 BYTE), 
	"AA_CTA_EXTERIOR" VARCHAR2(1 BYTE), 
	"AA_MONTO_OPR" NUMBER(19,2), 
	"AA_MONTO_PROMEDIO" NUMBER(19,2), 
	"AA_MONTO_VENTA_OPR" NUMBER(19,2), 
	"AA_MONTO_PROM_VENT" NUMBER(19,2), 
	"CURRENCY_CD_BASE" VARCHAR2(3 BYTE), 
	"AA_TOTAL_VENTA_USD" NUMBER(19,2), 
	"AA_TOTAL_VENTA_COP" NUMBER(19,2), 
	"AA_TOTAL_COMPR_USD" NUMBER(19,2), 
	"AA_TOTAL_COMPR_COP" NUMBER(19,2), 
	"AA_AUTORIZA_DIVISA" VARCHAR2(2 BYTE), 
	"DATE_END" DATE, 
	"AA_SOPORTE_DIVISA" VARCHAR2(4 BYTE), 
	"AA_TIPO_VIGENCIA" VARCHAR2(1 BYTE), 
	"AA_BLOQUEO_DIVISAS" VARCHAR2(4 BYTE), 
	"ROW_ADDED_DTTM" TIMESTAMP (6), 
	"ROW_ADDED_OPRID" VARCHAR2(30 BYTE), 
	"ROW_LASTMANT_DTTM" TIMESTAMP (6), 
	"ROW_LASTMANT_OPRID" VARCHAR2(30 BYTE), 
	"AV_OFICINA_ADI" VARCHAR2(6 BYTE), 
	"AA_ORIGEN" VARCHAR2(30 BYTE), 
	"AV_OFICINA_MOD" VARCHAR2(6 BYTE), 
	"AA_ORIGEN_MOD" VARCHAR2(30 BYTE), 
	"AA_ESTADO_AUTORIZA" VARCHAR2(30 BYTE)
   ) ;

  CREATE TABLE "DIVISAS"."PS_AA_PJ_OPR_INTER" 
   (	"NRO_IDENTIDAD" NUMBER(20,0), 
	"TIPO_IDENTIDAD" CHAR(1 BYTE), 
	"SETID" VARCHAR2(5 BYTE), 
	"AA_BANCO" VARCHAR2(50 BYTE), 
	"AA_CIUDAD_OPR" VARCHAR2(18 BYTE), 
	"CURRENCY_CD" VARCHAR2(3 BYTE), 
	"AA_NRO_CUENTA" VARCHAR2(20 BYTE), 
	"COUNTRY" VARCHAR2(3 BYTE), 
	"AA_TIPO_CUENTA" VARCHAR2(2 BYTE), 
	"AA_DIVISAS" VARCHAR2(1 BYTE), 
	"AA_IMPORTACION" VARCHAR2(1 BYTE), 
	"AA_EXPORTACION" VARCHAR2(1 BYTE), 
	"AA_INVERSION" VARCHAR2(1 BYTE), 
	"AA_GIROS" VARCHAR2(1 BYTE), 
	"AA_ENVIO_GIROS" VARCHAR2(1 BYTE), 
	"AA_SERVICIOS" VARCHAR2(1 BYTE), 
	"AA_PRESTAMOS" VARCHAR2(1 BYTE), 
	"AA_CTA_EXTERIOR" VARCHAR2(1 BYTE), 
	"AA_MONTO_OPR" NUMBER(19,2), 
	"AA_MONTO_PROMEDIO" NUMBER(19,2), 
	"AA_MONTO_VENTA_OPR" NUMBER(19,2), 
	"AA_MONTO_PROM_VENT" NUMBER(19,2), 
	"CURRENCY_CD_BASE" VARCHAR2(3 BYTE), 
	"AA_TOTAL_VENTA_USD" NUMBER(19,2), 
	"AA_TOTAL_VENTA_COP" NUMBER(19,2), 
	"AA_TOTAL_COMPR_USD" NUMBER(19,2), 
	"AA_TOTAL_COMPR_COP" NUMBER(19,2), 
	"AA_AUTORIZA_DIVISA" VARCHAR2(2 BYTE), 
	"DATE_END" DATE, 
	"ROW_LASTMANT_DTTM" TIMESTAMP (6), 
	"ROW_LASTMANT_OPRID" VARCHAR2(30 BYTE), 
	"AA_SALDO_DISPON" NUMBER(18,2), 
	"AA_TIPO_CUENT_CUAL" VARCHAR2(254 BYTE), 
	"AA_FUNC_AUTORIZA" VARCHAR2(13 BYTE), 
	"AA_SALDO_FIN" NUMBER(18,2), 
	"ROW_ADDED_DTTM" TIMESTAMP (6), 
	"ROW_ADDED_OPRID" VARCHAR2(30 BYTE), 
	"AV_OFICINA_ADI" VARCHAR2(6 BYTE), 
	"AA_ORIGEN" VARCHAR2(30 BYTE), 
	"AV_OFICINA_MOD" VARCHAR2(6 BYTE), 
	"AA_ORIGEN_MOD" VARCHAR2(30 BYTE)
   ) ;


  CREATE TABLE "DIVISAS"."PS_AA_PN_OPR_INTDT" 
   (	"NRO_IDENTIDAD" NUMBER(13,0), 
	"TIPO_IDENTIDAD" CHAR(1 BYTE), 
	"SEQ_NBR" NUMBER(15,0), 
	"AA_CIUDAD_OPR" VARCHAR2(18 BYTE), 
	"AA_ENTIDAD_OPR" VARCHAR2(50 BYTE), 
	"CURRENCY_CD" VARCHAR2(3 BYTE), 
	"CURRENCY_CD_BASE" VARCHAR2(3 BYTE), 
	"AA_AUTORIZA_DIVISA" VARCHAR2(2 BYTE), 
	"DATE_END" DATE, 
	"AA_TOTAL_VENTA_USD" NUMBER(19,2), 
	"AA_TOTAL_VENTA_COP" NUMBER(19,2), 
	"AA_TOTAL_COMPR_USD" NUMBER(19,2), 
	"AA_TOTAL_COMPR_COP" NUMBER(19,2), 
	"AA_NRO_CUENTA" VARCHAR2(20 BYTE), 
	"COUNTRY" VARCHAR2(3 BYTE), 
	"AA_TIPO_CUENTA" VARCHAR2(2 BYTE), 
	"AA_DIVISAS" VARCHAR2(1 BYTE), 
	"AA_IMPORTACION" VARCHAR2(1 BYTE), 
	"AA_EXPORTACION" VARCHAR2(1 BYTE), 
	"AA_INVERSION" VARCHAR2(1 BYTE), 
	"AA_GIROS" VARCHAR2(1 BYTE), 
	"AA_ENVIO_GIROS" VARCHAR2(1 BYTE), 
	"AA_SERVICIOS" VARCHAR2(1 BYTE), 
	"AA_PRESTAMOS" VARCHAR2(1 BYTE), 
	"AA_CTA_EXTERIOR" VARCHAR2(1 BYTE), 
	"AA_MONTO_OPR" NUMBER(19,2), 
	"AA_MONTO_PROMEDIO" NUMBER(19,2), 
	"AA_MONTO_VENTA_OPR" NUMBER(19,2), 
	"AA_MONTO_PROM_VENT" NUMBER(19,2), 
	"AA_SOPORTE_DIVISA" VARCHAR2(4 BYTE), 
	"AA_TIPO_VIGENCIA" VARCHAR2(1 BYTE), 
	"AA_SALDO_DISPON" NUMBER(18,2), 
	"AA_BLOQUEO_DIVISAS" VARCHAR2(4 BYTE), 
	"ROW_ADDED_DTTM" TIMESTAMP (6), 
	"ROW_ADDED_OPRID" VARCHAR2(30 BYTE), 
	"ROW_LASTMANT_DTTM" TIMESTAMP (6), 
	"ROW_LASTMANT_OPRID" VARCHAR2(30 BYTE), 
	"AV_OFICINA_ADI" VARCHAR2(6 BYTE), 
	"AA_ORIGEN" VARCHAR2(30 BYTE), 
	"AV_OFICINA_MOD" VARCHAR2(6 BYTE), 
	"AA_ORIGEN_MOD" VARCHAR2(30 BYTE), 
	"AA_ESTADO_AUTORIZA" VARCHAR2(20 BYTE), 
	"AA_AUTORIZACION_DIV" VARCHAR2(20 BYTE)
   )  ;



  CREATE TABLE "DIVISAS"."PS_AA_PN_OPR_INTER" 
   (	"NRO_IDENTIDAD" NUMBER(13,0), 
	"TIPO_IDENTIDAD" CHAR(1 BYTE), 
	"AA_CIUDAD_OPR" VARCHAR2(18 BYTE), 
	"AA_ENTIDAD_OPR" VARCHAR2(50 BYTE), 
	"CURRENCY_CD" VARCHAR2(3 BYTE), 
	"CURRENCY_CD_BASE" VARCHAR2(3 BYTE), 
	"AA_AUTORIZA_DIVISA" VARCHAR2(2 BYTE), 
	"DATE_END" DATE, 
	"AA_TOTAL_VENTA_USD" NUMBER(19,2), 
	"AA_TOTAL_VENTA_COP" NUMBER(19,2), 
	"AA_TOTAL_COMPR_USD" NUMBER(19,2), 
	"AA_TOTAL_COMPR_COP" NUMBER(19,2), 
	"ROW_LASTMANT_DTTM" TIMESTAMP (6), 
	"ROW_LASTMANT_OPRID" VARCHAR2(30 BYTE), 
	"AA_NRO_CUENTA" VARCHAR2(20 BYTE), 
	"COUNTRY" VARCHAR2(3 BYTE), 
	"AA_TIPO_CUENTA" VARCHAR2(2 BYTE), 
	"AA_DIVISAS" VARCHAR2(1 BYTE), 
	"AA_IMPORTACION" VARCHAR2(1 BYTE), 
	"AA_EXPORTACION" VARCHAR2(1 BYTE), 
	"AA_INVERSION" VARCHAR2(1 BYTE), 
	"AA_GIROS" VARCHAR2(1 BYTE), 
	"AA_ENVIO_GIROS" VARCHAR2(1 BYTE), 
	"AA_SERVICIOS" VARCHAR2(1 BYTE), 
	"AA_PRESTAMOS" VARCHAR2(1 BYTE), 
	"AA_CTA_EXTERIOR" VARCHAR2(1 BYTE), 
	"AA_MONTO_OPR" NUMBER(19,2), 
	"AA_MONTO_PROMEDIO" NUMBER(19,2), 
	"AA_MONTO_VENTA_OPR" NUMBER(19,2), 
	"AA_MONTO_PROM_VENT" NUMBER(19,2), 
	"AA_SALDO_DISPON" NUMBER(18,2), 
	"AA_TIPO_CUENT_CUAL" VARCHAR2(254 BYTE), 
	"AA_FUNC_AUTORIZA" VARCHAR2(13 BYTE), 
	"AA_SALDO_FIN" NUMBER(18,2), 
	"AA_COD_OFICINA" VARCHAR2(6 BYTE), 
	"AA_COD_OFICINA_MOD" VARCHAR2(6 BYTE), 
	"ROW_ADDED_DTTM" TIMESTAMP (6), 
	"ROW_ADDED_OPRID" VARCHAR2(30 BYTE), 
	"AV_OFICINA_ADI" VARCHAR2(6 BYTE), 
	"AA_ORIGEN" VARCHAR2(30 BYTE), 
	"AV_OFICINA_MOD" VARCHAR2(6 BYTE), 
	"AA_ORIGEN_MOD" VARCHAR2(30 BYTE)
   ) ;



  CREATE TABLE "DIVISAS"."PS_AV_DIV_MOV_PJ_H" 
   (	"ACTIONDTTM" TIMESTAMP (6), 
	"APPLIED_OPRID" VARCHAR2(30 BYTE), 
	"AV_TIP_ACCION" VARCHAR2(1 BYTE), 
	"APPLIED_OPRID2" VARCHAR2(30 BYTE), 
	"NRO_IDENTIDAD" NUMBER(20,0), 
	"TIPO_IDENTIDAD" CHAR(1 BYTE), 
	"SETID" VARCHAR2(5 BYTE), 
	"SEQ_NBR" NUMBER(15,0), 
	"AA_FECHA_TX" DATE, 
	"AA_COD_AUTORIZ" VARCHAR2(4 BYTE), 
	"AA_MONTO_OPR" NUMBER(19,2), 
	"CURRENCY_CD" VARCHAR2(3 BYTE), 
	"PARTICIPATION_PCT" NUMBER(8,2), 
	"AA_MONTO_TASA" NUMBER(19,2), 
	"AA_TIPO_DIVISA" VARCHAR2(1 BYTE), 
	"ROW_ADDED_DTTM" TIMESTAMP (6), 
	"ROW_ADDED_OPRID" VARCHAR2(30 BYTE), 
	"ROW_LASTMANT_DTTM" TIMESTAMP (6), 
	"ROW_LASTMANT_OPRID" VARCHAR2(30 BYTE), 
	"SYNCID" NUMBER(*,0), 
	"SYNCDTTM" TIMESTAMP (6), 
	"AV_OFICINA_ADI" VARCHAR2(6 BYTE), 
	"AA_ORIGEN" VARCHAR2(30 BYTE), 
	"AV_OFICINA_MOD" VARCHAR2(6 BYTE), 
	"AA_ORIGEN_MOD" VARCHAR2(30 BYTE)
   );

  CREATE TABLE "DIVISAS"."PS_AV_ENTI_OPRPJ_H" 
   (	"NRO_IDENTIDAD" NUMBER(20,0), 
	"TIPO_IDENTIDAD" CHAR(1 BYTE), 
	"ACTIONDTTM" TIMESTAMP (6), 
	"APPLIED_OPRID" VARCHAR2(30 BYTE), 
	"AV_TIP_ACCION" VARCHAR2(1 BYTE), 
	"APPLIED_OPRID2" VARCHAR2(30 BYTE), 
	"SETID" VARCHAR2(5 BYTE), 
	"AA_COD_ENTIDAD" VARCHAR2(5 BYTE), 
	"AA_SECUENCIA" NUMBER(*,0), 
	"ROW_ADDED_DTTM" TIMESTAMP (6), 
	"ROW_ADDED_OPRID" VARCHAR2(30 BYTE), 
	"ROW_LASTMANT_DTTM" TIMESTAMP (6), 
	"ROW_LASTMANT_OPRID" VARCHAR2(30 BYTE), 
	"SYNCID" NUMBER(*,0), 
	"SYNCDTTM" TIMESTAMP (6), 
	"AV_OFICINA_ADI" VARCHAR2(6 BYTE), 
	"AA_ORIGEN" VARCHAR2(30 BYTE), 
	"AV_OFICINA_MOD" VARCHAR2(6 BYTE), 
	"AA_ORIGEN_MOD" VARCHAR2(30 BYTE)
   );

  CREATE TABLE "DIVISAS"."PS_AV_ENTI_OPRPN_H" 
   (	"NRO_IDENTIDAD" NUMBER(20,0), 
	"TIPO_IDENTIDAD" CHAR(1 BYTE), 
	"ACTIONDTTM" TIMESTAMP (6), 
	"APPLIED_OPRID" VARCHAR2(30 BYTE), 
	"AV_TIP_ACCION" VARCHAR2(1 BYTE), 
	"APPLIED_OPRID2" VARCHAR2(30 BYTE), 
	"AA_COD_ENTIDAD" VARCHAR2(5 BYTE), 
	"AA_SECUENCIA" NUMBER(*,0), 
	"ROW_ADDED_DTTM" TIMESTAMP (6), 
	"ROW_ADDED_OPRID" VARCHAR2(30 BYTE), 
	"ROW_LASTMANT_DTTM" TIMESTAMP (6), 
	"ROW_LASTMANT_OPRID" VARCHAR2(30 BYTE), 
	"SYNCID" NUMBER(*,0), 
	"SYNCDTTM" TIMESTAMP (6), 
	"AV_OFICINA_ADI" VARCHAR2(6 BYTE), 
	"AA_ORIGEN" VARCHAR2(30 BYTE), 
	"AV_OFICINA_MOD" VARCHAR2(6 BYTE), 
	"AA_ORIGEN_MOD" VARCHAR2(30 BYTE)
   )  ;


  CREATE TABLE "DIVISAS"."PS_AV_PJ_O_INTDT_H" 
   (	"NRO_IDENTIDAD" NUMBER(20,0), 
	"TIPO_IDENTIDAD" CHAR(1 BYTE), 
	"ACTIONDTTM" TIMESTAMP (6), 
	"APPLIED_OPRID" VARCHAR2(30 BYTE), 
	"AV_TIP_ACCION" VARCHAR2(1 BYTE), 
	"APPLIED_OPRID2" VARCHAR2(30 BYTE), 
	"SETID" VARCHAR2(5 BYTE), 
	"SEQ_NBR" NUMBER(15,0), 
	"AA_BANCO" VARCHAR2(50 BYTE), 
	"AA_CIUDAD_OPR" VARCHAR2(18 BYTE), 
	"CURRENCY_CD" VARCHAR2(3 BYTE), 
	"AA_NRO_CUENTA" VARCHAR2(20 BYTE), 
	"COUNTRY" VARCHAR2(3 BYTE), 
	"AA_TIPO_CUENTA" VARCHAR2(2 BYTE), 
	"AA_DIVISAS" VARCHAR2(1 BYTE), 
	"AA_IMPORTACION" VARCHAR2(1 BYTE), 
	"AA_EXPORTACION" VARCHAR2(1 BYTE), 
	"AA_INVERSION" VARCHAR2(1 BYTE), 
	"AA_GIROS" VARCHAR2(1 BYTE), 
	"AA_ENVIO_GIROS" VARCHAR2(1 BYTE), 
	"AA_SERVICIOS" VARCHAR2(1 BYTE), 
	"AA_PRESTAMOS" VARCHAR2(1 BYTE), 
	"AA_CTA_EXTERIOR" VARCHAR2(1 BYTE), 
	"AA_MONTO_OPR" NUMBER(19,2), 
	"AA_MONTO_PROMEDIO" NUMBER(19,2), 
	"AA_MONTO_VENTA_OPR" NUMBER(19,2), 
	"AA_MONTO_PROM_VENT" NUMBER(19,2), 
	"CURRENCY_CD_BASE" VARCHAR2(3 BYTE), 
	"AA_TOTAL_VENTA_USD" NUMBER(19,2), 
	"AA_TOTAL_VENTA_COP" NUMBER(19,2), 
	"AA_TOTAL_COMPR_USD" NUMBER(19,2), 
	"AA_TOTAL_COMPR_COP" NUMBER(19,2), 
	"AA_AUTORIZA_DIVISA" VARCHAR2(2 BYTE), 
	"DATE_END" DATE, 
	"AA_SOPORTE_DIVISA" VARCHAR2(4 BYTE), 
	"AA_TIPO_VIGENCIA" VARCHAR2(1 BYTE), 
	"AA_BLOQUEO_DIVISAS" VARCHAR2(4 BYTE), 
	"ROW_ADDED_DTTM" TIMESTAMP (6), 
	"ROW_ADDED_OPRID" VARCHAR2(30 BYTE), 
	"ROW_LASTMANT_DTTM" TIMESTAMP (6), 
	"ROW_LASTMANT_OPRID" VARCHAR2(30 BYTE), 
	"AV_OFICINA_ADI" VARCHAR2(6 BYTE), 
	"AA_ORIGEN" VARCHAR2(30 BYTE), 
	"AV_OFICINA_MOD" VARCHAR2(6 BYTE), 
	"AA_ORIGEN_MOD" VARCHAR2(30 BYTE)
   )  ;


  CREATE TABLE "DIVISAS"."PS_AV_PJ_O_INTER_H" 
   (	"NRO_IDENTIDAD" NUMBER(25,0), 
	"TIPO_IDENTIDAD" CHAR(1 BYTE), 
	"ACTIONDTTM" TIMESTAMP (6), 
	"APPLIED_OPRID" VARCHAR2(30 BYTE), 
	"AV_TIP_ACCION" VARCHAR2(1 BYTE), 
	"APPLIED_OPRID2" VARCHAR2(30 BYTE), 
	"SETID" VARCHAR2(5 BYTE), 
	"AA_BANCO" VARCHAR2(50 BYTE), 
	"AA_CIUDAD_OPR" VARCHAR2(18 BYTE), 
	"CURRENCY_CD" VARCHAR2(3 BYTE), 
	"AA_NRO_CUENTA" VARCHAR2(20 BYTE), 
	"COUNTRY" VARCHAR2(3 BYTE), 
	"AA_TIPO_CUENTA" VARCHAR2(2 BYTE), 
	"AA_DIVISAS" VARCHAR2(1 BYTE), 
	"AA_IMPORTACION" VARCHAR2(1 BYTE), 
	"AA_EXPORTACION" VARCHAR2(1 BYTE), 
	"AA_INVERSION" VARCHAR2(1 BYTE), 
	"AA_GIROS" VARCHAR2(1 BYTE), 
	"AA_ENVIO_GIROS" VARCHAR2(1 BYTE), 
	"AA_SERVICIOS" VARCHAR2(1 BYTE), 
	"AA_PRESTAMOS" VARCHAR2(1 BYTE), 
	"AA_CTA_EXTERIOR" VARCHAR2(1 BYTE), 
	"AA_MONTO_OPR" NUMBER(19,2), 
	"AA_MONTO_PROMEDIO" NUMBER(19,2), 
	"AA_MONTO_VENTA_OPR" NUMBER(19,2), 
	"AA_MONTO_PROM_VENT" NUMBER(19,2), 
	"CURRENCY_CD_BASE" VARCHAR2(3 BYTE), 
	"AA_TOTAL_VENTA_USD" NUMBER(19,2), 
	"AA_TOTAL_VENTA_COP" NUMBER(19,2), 
	"AA_TOTAL_COMPR_USD" NUMBER(19,2), 
	"AA_TOTAL_COMPR_COP" NUMBER(19,2), 
	"AA_AUTORIZA_DIVISA" VARCHAR2(2 BYTE), 
	"DATE_END" DATE, 
	"ROW_LASTMANT_DTTM" TIMESTAMP (6), 
	"ROW_LASTMANT_OPRID" VARCHAR2(30 BYTE), 
	"AA_SALDO_DISPON" NUMBER(18,2), 
	"AA_TIPO_CUENT_CUAL" VARCHAR2(254 BYTE), 
	"AA_FUNC_AUTORIZA" VARCHAR2(13 BYTE), 
	"AA_SALDO_FIN" NUMBER(18,2), 
	"ROW_ADDED_DTTM" TIMESTAMP (6), 
	"ROW_ADDED_OPRID" VARCHAR2(30 BYTE), 
	"AV_OFICINA_ADI" VARCHAR2(6 BYTE), 
	"AA_ORIGEN" VARCHAR2(30 BYTE), 
	"AV_OFICINA_MOD" VARCHAR2(6 BYTE), 
	"AA_ORIGEN_MOD" VARCHAR2(30 BYTE)
   ) ;

  CREATE TABLE "DIVISAS"."PS_AV_PN_O_INTDT_H" 
   (	"NRO_IDENTIDAD" NUMBER(13,0), 
	"TIPO_IDENTIDAD" CHAR(1 BYTE), 
	"ACTIONDTTM" TIMESTAMP (6), 
	"APPLIED_OPRID" VARCHAR2(30 BYTE), 
	"AV_TIP_ACCION" VARCHAR2(1 BYTE), 
	"APPLIED_OPRID2" VARCHAR2(30 BYTE), 
	"SEQ_NBR" NUMBER(15,0), 
	"AA_CIUDAD_OPR" VARCHAR2(18 BYTE), 
	"AA_ENTIDAD_OPR" VARCHAR2(50 BYTE), 
	"CURRENCY_CD" VARCHAR2(3 BYTE), 
	"CURRENCY_CD_BASE" VARCHAR2(3 BYTE), 
	"AA_AUTORIZA_DIVISA" VARCHAR2(2 BYTE), 
	"DATE_END" DATE, 
	"AA_TOTAL_VENTA_USD" NUMBER(19,2), 
	"AA_TOTAL_VENTA_COP" NUMBER(19,2), 
	"AA_TOTAL_COMPR_USD" NUMBER(19,2), 
	"AA_TOTAL_COMPR_COP" NUMBER(19,2), 
	"AA_NRO_CUENTA" VARCHAR2(20 BYTE), 
	"COUNTRY" VARCHAR2(3 BYTE), 
	"AA_TIPO_CUENTA" VARCHAR2(2 BYTE), 
	"AA_DIVISAS" VARCHAR2(1 BYTE), 
	"AA_IMPORTACION" VARCHAR2(1 BYTE), 
	"AA_EXPORTACION" VARCHAR2(1 BYTE), 
	"AA_INVERSION" VARCHAR2(1 BYTE), 
	"AA_GIROS" VARCHAR2(1 BYTE), 
	"AA_ENVIO_GIROS" VARCHAR2(1 BYTE), 
	"AA_SERVICIOS" VARCHAR2(1 BYTE), 
	"AA_PRESTAMOS" VARCHAR2(1 BYTE), 
	"AA_CTA_EXTERIOR" VARCHAR2(1 BYTE), 
	"AA_MONTO_OPR" NUMBER(19,2), 
	"AA_MONTO_PROMEDIO" NUMBER(19,2), 
	"AA_MONTO_VENTA_OPR" NUMBER(19,2), 
	"AA_MONTO_PROM_VENT" NUMBER(19,2), 
	"AA_SOPORTE_DIVISA" VARCHAR2(4 BYTE), 
	"AA_TIPO_VIGENCIA" VARCHAR2(1 BYTE), 
	"AA_SALDO_DISPON" NUMBER(18,2), 
	"AA_BLOQUEO_DIVISAS" VARCHAR2(4 BYTE), 
	"ROW_ADDED_DTTM" TIMESTAMP (6), 
	"ROW_ADDED_OPRID" VARCHAR2(30 BYTE), 
	"ROW_LASTMANT_DTTM" TIMESTAMP (6), 
	"ROW_LASTMANT_OPRID" VARCHAR2(30 BYTE), 
	"AV_OFICINA_ADI" VARCHAR2(6 BYTE), 
	"AA_ORIGEN" VARCHAR2(30 BYTE), 
	"AV_OFICINA_MOD" VARCHAR2(6 BYTE), 
	"AA_ORIGEN_MOD" VARCHAR2(30 BYTE)
   )  ;


  CREATE TABLE "DIVISAS"."PS_AV_PN_O_INTER_H" 
   (	"NRO_IDENTIDAD" NUMBER(20,0), 
	"TIPO_IDENTIDAD" CHAR(1 BYTE), 
	"ACTIONDTTM" DATE, 
	"APPLIED_OPRID" VARCHAR2(30 BYTE), 
	"AV_TIP_ACCION" VARCHAR2(1 BYTE), 
	"APPLIED_OPRID2" VARCHAR2(30 BYTE), 
	"AA_CIUDAD_OPR" VARCHAR2(18 BYTE), 
	"AA_ENTIDAD_OPR" VARCHAR2(50 BYTE), 
	"CURRENCY_CD" VARCHAR2(3 BYTE), 
	"CURRENCY_CD_BASE" VARCHAR2(3 BYTE), 
	"AA_AUTORIZA_DIVISA" VARCHAR2(2 BYTE), 
	"DATE_END" DATE, 
	"AA_TOTAL_VENTA_USD" NUMBER(19,2), 
	"AA_TOTAL_VENTA_COP" NUMBER(19,2), 
	"AA_TOTAL_COMPR_USD" NUMBER(19,2), 
	"AA_TOTAL_COMPR_COP" NUMBER(19,2), 
	"ROW_LASTMANT_DTTM" DATE, 
	"ROW_LASTMANT_OPRID" VARCHAR2(30 BYTE), 
	"AA_NRO_CUENTA" VARCHAR2(20 BYTE), 
	"COUNTRY" VARCHAR2(3 BYTE), 
	"AA_TIPO_CUENTA" VARCHAR2(2 BYTE), 
	"AA_DIVISAS" VARCHAR2(1 BYTE), 
	"AA_IMPORTACION" VARCHAR2(1 BYTE), 
	"AA_EXPORTACION" VARCHAR2(1 BYTE), 
	"AA_INVERSION" VARCHAR2(1 BYTE), 
	"AA_GIROS" VARCHAR2(1 BYTE), 
	"AA_ENVIO_GIROS" VARCHAR2(1 BYTE), 
	"AA_SERVICIOS" VARCHAR2(1 BYTE), 
	"AA_PRESTAMOS" VARCHAR2(1 BYTE), 
	"AA_CTA_EXTERIOR" VARCHAR2(1 BYTE), 
	"AA_MONTO_OPR" NUMBER(19,2), 
	"AA_MONTO_PROMEDIO" NUMBER(19,2), 
	"AA_MONTO_VENTA_OPR" NUMBER(19,2), 
	"AA_MONTO_PROM_VENT" NUMBER(19,2), 
	"AA_SALDO_DISPON" NUMBER(18,2), 
	"AA_TIPO_CUENT_CUAL" VARCHAR2(254 BYTE), 
	"AA_FUNC_AUTORIZA" VARCHAR2(13 BYTE), 
	"AA_SALDO_FIN" NUMBER(18,2), 
	"AA_COD_OFICINA" VARCHAR2(6 BYTE), 
	"AA_COD_OFICINA_MOD" VARCHAR2(6 BYTE), 
	"ROW_ADDED_DTTM" DATE, 
	"ROW_ADDED_OPRID" VARCHAR2(30 BYTE), 
	"AV_OFICINA_ADI" VARCHAR2(6 BYTE), 
	"AA_ORIGEN" VARCHAR2(30 BYTE), 
	"AV_OFICINA_MOD" VARCHAR2(6 BYTE), 
	"AA_ORIGEN_MOD" VARCHAR2(30 BYTE)
   )  ;


  CREATE TABLE "DIVISAS"."PS_COUNTRY_TBL" 
   (	"COUNTRY" VARCHAR2(3 BYTE), 
	"DESCR" VARCHAR2(30 BYTE), 
	"DESCRSHORT" VARCHAR2(10 BYTE), 
	"COUNTRY_2CHAR" VARCHAR2(2 BYTE), 
	"EU_MEMBER_STATE" VARCHAR2(1 BYTE), 
	"ADDR1_LBL" VARCHAR2(15 BYTE), 
	"ADDR1_AVAIL" VARCHAR2(1 BYTE), 
	"ADDR2_LBL" VARCHAR2(15 BYTE), 
	"ADDR2_AVAIL" VARCHAR2(1 BYTE), 
	"ADDR3_LBL" VARCHAR2(15 BYTE), 
	"ADDR3_AVAIL" VARCHAR2(1 BYTE), 
	"ADDR4_LBL" VARCHAR2(15 BYTE), 
	"ADDR4_AVAIL" VARCHAR2(1 BYTE), 
	"CITY_LBL" VARCHAR2(15 BYTE), 
	"CITY_AVAIL" VARCHAR2(1 BYTE), 
	"NUM1_LBL" VARCHAR2(15 BYTE), 
	"NUM1_AVAIL" VARCHAR2(1 BYTE), 
	"NUM2_LBL" VARCHAR2(15 BYTE), 
	"NUM2_AVAIL" VARCHAR2(1 BYTE), 
	"HOUSE_TYPE_LBL" VARCHAR2(15 BYTE), 
	"HOUSE_TYPE_AVAIL" VARCHAR2(1 BYTE), 
	"ADDR_FIELD1_LBL" VARCHAR2(15 BYTE), 
	"ADDR_FIELD1_AVAIL" VARCHAR2(1 BYTE), 
	"ADDR_FIELD2_LBL" VARCHAR2(15 BYTE), 
	"ADDR_FIELD2_AVAIL" VARCHAR2(1 BYTE), 
	"ADDR_FIELD3_LBL" VARCHAR2(15 BYTE), 
	"ADDR_FIELD3_AVAIL" VARCHAR2(1 BYTE), 
	"COUNTY_LBL" VARCHAR2(15 BYTE), 
	"COUNTY_AVAIL" VARCHAR2(1 BYTE), 
	"STATE_LBL" VARCHAR2(15 BYTE), 
	"STATE_AVAIL" VARCHAR2(1 BYTE), 
	"POSTAL_LBL" VARCHAR2(15 BYTE), 
	"POSTAL_AVAIL" VARCHAR2(1 BYTE), 
	"IN_CITY_LIM_AVAIL" VARCHAR2(1 BYTE), 
	"IN_CITY_LIM_LBL" VARCHAR2(15 BYTE), 
	"GEO_CODE_AVAIL" VARCHAR2(1 BYTE), 
	"GEO_CODE_LBL" VARCHAR2(15 BYTE), 
	"POST_SRCH_AVAIL" VARCHAR2(1 BYTE), 
	"GBSYS_NRPATH_UK" VARCHAR2(254 BYTE), 
	"GBSYS_CFGPATH_UK" VARCHAR2(254 BYTE), 
	"SYNCID" NUMBER(*,0), 
	"SYNCDTTM" DATE
   ) ;


  CREATE TABLE "DIVISAS"."PS_CURRENCY_CD_TBL" 
   (	"CURRENCY_CD" VARCHAR2(3 BYTE), 
	"EFFDT" DATE, 
	"EFF_STATUS" VARCHAR2(1 BYTE), 
	"DESCR" VARCHAR2(30 BYTE), 
	"DESCRSHORT" VARCHAR2(10 BYTE), 
	"COUNTRY" VARCHAR2(3 BYTE), 
	"CUR_SYMBOL" VARCHAR2(4 BYTE), 
	"DECIMAL_POSITIONS" NUMBER(*,0), 
	"SCALE_POSITIONS" NUMBER(*,0), 
	"SYNCID" NUMBER(*,0), 
	"LASTUPDDTTM" TIMESTAMP (6)
   );



 CREATE UNIQUE INDEX "DIVISAS"."PS_AA_PN_OPR_INTER" ON "DIVISAS"."PS_AA_PN_OPR_INTER" ("NRO_IDENTIDAD", "TIPO_IDENTIDAD");



  CREATE OR REPLACE EDITIONABLE TRIGGER "DIVISAS"."AV_DIV_MOV_PJ_D_TGR" 
  before delete on DIVISAS.PS_AA_DIV_MOV_PJ
  for each row

Begin
  INSERT into PS_AV_DIV_MOV_PJ_H (
         ACTIONDTTM, APPLIED_OPRID, AV_TIP_ACCION, APPLIED_OPRID2,
         NRO_IDENTIDAD,TIPO_IDENTIDAD, SETID, SEQ_NBR, AA_FECHA_TX, AA_COD_AUTORIZ,
         AA_MONTO_OPR, CURRENCY_CD, PARTICIPATION_PCT, AA_MONTO_TASA, AA_TIPO_DIVISA,
         ROW_ADDED_DTTM, ROW_ADDED_OPRID, ROW_LASTMANT_DTTM,
         ROW_LASTMANT_OPRID, SYNCID, SYNCDTTM,
         AV_OFICINA_ADI, AA_ORIGEN, AV_OFICINA_MOD, AA_ORIGEN_MOD)
  VALUES (sysdate, user, 'E', ' ', :OLD.NRO_IDENTIDAD,:OLD.TIPO_IDENTIDAD, :OLD.SETID, :OLD.SEQ_NBR, :OLD.AA_FECHA_TX, :OLD.AA_COD_AUTORIZ,
         :OLD.AA_MONTO_OPR, :OLD.CURRENCY_CD, :OLD.PARTICIPATION_PCT, :OLD.AA_MONTO_TASA, :OLD.AA_TIPO_DIVISA,
         :OLD.ROW_ADDED_DTTM, :OLD.ROW_ADDED_OPRID,
         :OLD.ROW_LASTMANT_DTTM, :OLD.ROW_LASTMANT_OPRID, :OLD.SYNCID, :OLD.SYNCDTTM,
         :OLD.AV_OFICINA_ADI, :OLD.AA_ORIGEN, :OLD.AV_OFICINA_MOD, :OLD.AA_ORIGEN_MOD);
  EXCEPTION WHEN Dup_Val_On_Index THEN NULL;

end AV_DIV_MOV_PJ_D_TGR;

/
ALTER TRIGGER "DIVISAS"."AV_DIV_MOV_PJ_D_TGR" ENABLE;





  CREATE OR REPLACE EDITIONABLE TRIGGER "DIVISAS"."AV_DIV_MOV_PJ_I_TGR" 
/* --------------------------------------------------------------------------------------
   AUTOR     FECHA        REF COMENTARIO
   GMARTRUS  23-OCT-2009  001 Trigger que peromite guardar el historial de la tabla
   CIMA                       PS_AA_DIV_MOV_PJ.
   -------------------------------------------------------------------------------------- */
  after insert on PS_AA_DIV_MOV_PJ
  for each row
/* Inicio 001 */
Begin
  /* Se guarda el histoico de la tabla */
  INSERT into PS_AV_DIV_MOV_PJ_H (
         ACTIONDTTM, APPLIED_OPRID, AV_TIP_ACCION, APPLIED_OPRID2,
         NRO_IDENTIDAD,TIPO_IDENTIDAD, SETID, SEQ_NBR, AA_FECHA_TX, AA_COD_AUTORIZ,
         AA_MONTO_OPR, CURRENCY_CD, PARTICIPATION_PCT, AA_MONTO_TASA, AA_TIPO_DIVISA,
         ROW_ADDED_DTTM, ROW_ADDED_OPRID, ROW_LASTMANT_DTTM,
         ROW_LASTMANT_OPRID, SYNCID, SYNCDTTM,
         AV_OFICINA_ADI, AA_ORIGEN, AV_OFICINA_MOD, AA_ORIGEN_MOD)
  VALUES (sysdate, user, 'I', :NEW.ROW_ADDED_OPRID, :NEW.NRO_IDENTIDAD,:NEW.TIPO_IDENTIDAD, :NEW.SETID, :NEW.SEQ_NBR, :NEW.AA_FECHA_TX, :NEW.AA_COD_AUTORIZ,
         :NEW.AA_MONTO_OPR, :NEW.CURRENCY_CD, :NEW.PARTICIPATION_PCT, :NEW.AA_MONTO_TASA, :NEW.AA_TIPO_DIVISA,
         :NEW.ROW_ADDED_DTTM, :NEW.ROW_ADDED_OPRID,
         :NEW.ROW_LASTMANT_DTTM, :NEW.ROW_LASTMANT_OPRID, :NEW.SYNCID, :NEW.SYNCDTTM,
         :NEW.AV_OFICINA_ADI, :NEW.AA_ORIGEN, :NEW.AV_OFICINA_MOD, :NEW.AA_ORIGEN_MOD);
  EXCEPTION WHEN Dup_Val_On_Index THEN NULL;
/* Fin 001 */
end AV_DIV_MOV_PJ_I_TGR;

/
ALTER TRIGGER "DIVISAS"."AV_DIV_MOV_PJ_I_TGR" ENABLE;


  CREATE OR REPLACE EDITIONABLE TRIGGER "DIVISAS"."AV_DIV_MOV_PJ_U_TGR" 
/* --------------------------------------------------------------------------------------
   AUTOR     FECHA        REF COMENTARIO
   GMARTRUS  23-OCT-2009  001 Trigger que peromite guardar el historial de la tabla
   CIMA                       PS_AA_DIV_MOV_PJ.
   -------------------------------------------------------------------------------------- */
  before update on PS_AA_DIV_MOV_PJ
  for each row
/* Inicio 001 */
Begin
  /* Se guarda el histoico de la tabla */
  Begin
    INSERT into PS_AV_DIV_MOV_PJ_H (
           ACTIONDTTM, APPLIED_OPRID, AV_TIP_ACCION, APPLIED_OPRID2,
           NRO_IDENTIDAD,TIPO_IDENTIDAD, SETID, SEQ_NBR, AA_FECHA_TX, AA_COD_AUTORIZ,
           AA_MONTO_OPR, CURRENCY_CD, PARTICIPATION_PCT, AA_MONTO_TASA, AA_TIPO_DIVISA,
           ROW_ADDED_DTTM, ROW_ADDED_OPRID, ROW_LASTMANT_DTTM,
           ROW_LASTMANT_OPRID, SYNCID, SYNCDTTM,
           AV_OFICINA_ADI, AA_ORIGEN, AV_OFICINA_MOD, AA_ORIGEN_MOD)
    VALUES (sysdate, user, 'M', :NEW.ROW_LASTMANT_OPRID, :OLD.NRO_IDENTIDAD,:OLD.TIPO_IDENTIDAD, :OLD.SETID, :OLD.SEQ_NBR, :OLD.AA_FECHA_TX, :OLD.AA_COD_AUTORIZ,
           :OLD.AA_MONTO_OPR, :OLD.CURRENCY_CD, :OLD.PARTICIPATION_PCT, :OLD.AA_MONTO_TASA, :OLD.AA_TIPO_DIVISA,
           :OLD.ROW_ADDED_DTTM, :OLD.ROW_ADDED_OPRID,
           :OLD.ROW_LASTMANT_DTTM, :OLD.ROW_LASTMANT_OPRID, :OLD.SYNCID, :OLD.SYNCDTTM,
           :OLD.AV_OFICINA_ADI, :OLD.AA_ORIGEN, :OLD.AV_OFICINA_MOD, :OLD.AA_ORIGEN_MOD);
    EXCEPTION WHEN Dup_Val_On_Index THEN NULL;
  end;
/* Fin 001 */
end AV_DIV_MOV_PJ_U_TGR;

/
ALTER TRIGGER "DIVISAS"."AV_DIV_MOV_PJ_U_TGR" ENABLE;
--------------------------------------------------------
--  DDL for Trigger AV_ENTI_OPRPJ_D_TGR
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE TRIGGER "DIVISAS"."AV_ENTI_OPRPJ_D_TGR" 
/* --------------------------------------------------------------------------------------
   AUTOR     FECHA        REF COMENTARIO
   GMARTRUS  23-OCT-2009  001 Trigger que peromite guardar el historial de la tabla
   CIMA                       PS_AA_ENTI_OPRPJ.
   -------------------------------------------------------------------------------------- */
  before delete on ps_aa_enti_oprpj
  for each row
/* Inicio 001 */
Begin
  /* Se guarda el histoico de la tabla */
  INSERT into PS_AV_ENTI_OPRPJ_H
         (ACTIONDTTM, APPLIED_OPRID, AV_TIP_ACCION, APPLIED_OPRID2, SETID, NRO_IDENTIDAD,TIPO_IDENTIDAD, AA_COD_ENTIDAD,
         AA_SECUENCIA, ROW_ADDED_DTTM, ROW_ADDED_OPRID, ROW_LASTMANT_DTTM, ROW_LASTMANT_OPRID, SYNCID, SYNCDTTM,
         AV_OFICINA_ADI, AA_ORIGEN, AV_OFICINA_MOD, AA_ORIGEN_MOD)
  VALUES (sysdate, user, 'E', ' ', :old.SETID, :old.NRO_IDENTIDAD, :old.TIPO_IDENTIDAD, :old.AA_COD_ENTIDAD, :OLD.AA_SECUENCIA, :OLD.ROW_ADDED_DTTM,
         :OLD.ROW_ADDED_OPRID, :OLD.ROW_LASTMANT_DTTM, :OLD.ROW_LASTMANT_OPRID, :OLD.SYNCID, :OLD.SYNCDTTM,
         :OLD.AV_OFICINA_ADI, :OLD.AA_ORIGEN, :OLD.AV_OFICINA_MOD, :OLD.AA_ORIGEN_MOD);
  EXCEPTION WHEN Dup_Val_On_Index THEN NULL;
/* Fin 001 */
end AV_ENTI_OPRPJ_D_TGR;

/
ALTER TRIGGER "DIVISAS"."AV_ENTI_OPRPJ_D_TGR" ENABLE;
--------------------------------------------------------
--  DDL for Trigger AV_ENTI_OPRPJ_I_TGR
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE TRIGGER "DIVISAS"."AV_ENTI_OPRPJ_I_TGR" 
/* --------------------------------------------------------------------------------------
   AUTOR     FECHA        REF COMENTARIO
   GMARTRUS  23-OCT-2009  001 Trigger que peromite guardar el historial de la tabla
   CIMA                       PS_AA_ENTI_OPRPJ.
   -------------------------------------------------------------------------------------- */
  after insert on ps_aa_enti_oprpj
  for each row
/* Inicio 001 */
Begin
  /* Se guarda el histoico de la tabla */
  INSERT into PS_AV_ENTI_OPRPJ_H
         (ACTIONDTTM, APPLIED_OPRID, APPLIED_OPRID2, AV_TIP_ACCION, SETID, NRO_IDENTIDAD,TIPO_IDENTIDAD,AA_COD_ENTIDAD,
         AA_SECUENCIA, ROW_ADDED_DTTM, ROW_ADDED_OPRID, ROW_LASTMANT_DTTM, ROW_LASTMANT_OPRID, SYNCID, SYNCDTTM,
         AV_OFICINA_ADI, AA_ORIGEN, AV_OFICINA_MOD, AA_ORIGEN_MOD)
  VALUES (sysdate, user,:NEW.ROW_ADDED_OPRID,'I', :NEW.SETID,:NEW.NRO_IDENTIDAD, :NEW.TIPO_IDENTIDAD, :new.AA_COD_ENTIDAD, :NEW.AA_SECUENCIA, :NEW.ROW_ADDED_DTTM,
         :NEW.ROW_ADDED_OPRID, :NEW.ROW_LASTMANT_DTTM, :NEW.ROW_LASTMANT_OPRID, :NEW.SYNCID, :NEW.SYNCDTTM,
         :NEW.AV_OFICINA_ADI, :NEW.AA_ORIGEN, :NEW.AV_OFICINA_MOD, :NEW.AA_ORIGEN_MOD);
  EXCEPTION WHEN Dup_Val_On_Index THEN NULL;
/* Fin 001 */
end AV_ENTI_OPRPJ_I_TGR;

/
ALTER TRIGGER "DIVISAS"."AV_ENTI_OPRPJ_I_TGR" ENABLE;
--------------------------------------------------------
--  DDL for Trigger AV_ENTI_OPRPJ_U_TGR
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE TRIGGER "DIVISAS"."AV_ENTI_OPRPJ_U_TGR" 
/* --------------------------------------------------------------------------------------
   AUTOR     FECHA        REF COMENTARIO
   GMARTRUS  23-OCT-2009  001 Trigger que peromite guardar el historial de la tabla
   CIMA                       PS_AA_ENTI_OPRPJ.
   -------------------------------------------------------------------------------------- */
  before update on PS_AA_ENTI_OPRPJ
  for each row
/* Inicio 001 */
Begin
  /* Se guarda el histoico de la tabla */
  Begin
    INSERT into PS_AV_ENTI_OPRPJ_H
          (ACTIONDTTM, APPLIED_OPRID, AV_TIP_ACCION, APPLIED_OPRID2, SETID, NRO_IDENTIDAD,TIPO_IDENTIDAD, AA_COD_ENTIDAD,
           AA_SECUENCIA, ROW_ADDED_DTTM, ROW_ADDED_OPRID, ROW_LASTMANT_DTTM, ROW_LASTMANT_OPRID, SYNCID, SYNCDTTM,
           AV_OFICINA_ADI, AA_ORIGEN, AV_OFICINA_MOD, AA_ORIGEN_MOD)
    VALUES (sysdate, user, 'M', :NEW.ROW_LASTMANT_OPRID, :OLD.SETID, :OLD.NRO_IDENTIDAD, :OLD.TIPO_IDENTIDAD, :OLD.AA_COD_ENTIDAD, :OLD.AA_SECUENCIA, :OLD.ROW_ADDED_DTTM,
           :OLD.ROW_ADDED_OPRID, :OLD.ROW_LASTMANT_DTTM, :OLD.ROW_LASTMANT_OPRID, :OLD.SYNCID, :OLD.SYNCDTTM,
           :OLD.AV_OFICINA_ADI, :OLD.AA_ORIGEN, :OLD.AV_OFICINA_MOD, :OLD.AA_ORIGEN_MOD);
    EXCEPTION WHEN Dup_Val_On_Index THEN NULL;
  end;
/* Fin 001 */
end AV_ENTI_OPRPJ_U_TGR;

/
ALTER TRIGGER "DIVISAS"."AV_ENTI_OPRPJ_U_TGR" ENABLE;
--------------------------------------------------------
--  DDL for Trigger AV_ENTI_OPRPN_D_TGR
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE TRIGGER "DIVISAS"."AV_ENTI_OPRPN_D_TGR" 
/* --------------------------------------------------------------------------------------
   AUTOR     FECHA        REF COMENTARIO
   GMARTRUS  23-OCT-2009  001 Trigger que peromite guardar el historial de la tabla
   CIMA                       PS_AA_ENTI_OPRPN.
   -------------------------------------------------------------------------------------- */
  before delete on ps_aa_enti_oprpn
  for each row
/* Inicio 001 */
Begin
  /* Se guarda el histoico de la tabla */
  insert into PS_AV_ENTI_OPRPN_H
        (ACTIONDTTM, APPLIED_OPRID, AV_TIP_ACCION, APPLIED_OPRID2,NRO_IDENTIDAD,TIPO_IDENTIDAD, AA_COD_ENTIDAD, AA_SECUENCIA,
         ROW_ADDED_DTTM, ROW_ADDED_OPRID, ROW_LASTMANT_DTTM, ROW_LASTMANT_OPRID, SYNCID, SYNCDTTM,
         AV_OFICINA_ADI, AA_ORIGEN, AV_OFICINA_MOD, AA_ORIGEN_MOD)
  VALUES (sysdate, user, 'E', ' ', :old.NRO_IDENTIDAD,:old.TIPO_IDENTIDAD, :old.AA_COD_ENTIDAD, :OLD.AA_SECUENCIA, :OLD.ROW_ADDED_DTTM,
         :OLD.ROW_ADDED_OPRID, :OLD.ROW_LASTMANT_DTTM, :OLD.ROW_LASTMANT_OPRID, :OLD.SYNCID, :OLD.SYNCDTTM,
         :OLD.AV_OFICINA_ADI, :OLD.AA_ORIGEN, :OLD.AV_OFICINA_MOD, :OLD.AA_ORIGEN_MOD);
  EXCEPTION WHEN Dup_Val_On_Index THEN NULL;
/* Fin 001 */
end AV_ENTI_OPRPN_D_TGR;

/
ALTER TRIGGER "DIVISAS"."AV_ENTI_OPRPN_D_TGR" ENABLE;
--------------------------------------------------------
--  DDL for Trigger AV_ENTI_OPRPN_I_TGR
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE TRIGGER "DIVISAS"."AV_ENTI_OPRPN_I_TGR" 
/* --------------------------------------------------------------------------------------
   AUTOR     FECHA        REF COMENTARIO
   GMARTRUS  23-OCT-2009  001 Trigger que peromite guardar el historial de la tabla
   CIMA                       PS_AA_ENTI_OPRPN.
   -------------------------------------------------------------------------------------- */
  after insert on ps_aa_enti_oprpn
  for each row
/* Inicio 001 */
Begin
  /* Se guarda el histoico de la tabla */
 INSERT into PS_AV_ENTI_OPRPN_H
        (ACTIONDTTM, APPLIED_OPRID, AV_TIP_ACCION, APPLIED_OPRID2, NRO_IDENTIDAD,TIPO_IDENTIDAD, AA_COD_ENTIDAD, AA_SECUENCIA,
         ROW_ADDED_DTTM, ROW_ADDED_OPRID, ROW_LASTMANT_DTTM, ROW_LASTMANT_OPRID, SYNCID, SYNCDTTM,
         AV_OFICINA_ADI, AA_ORIGEN, AV_OFICINA_MOD, AA_ORIGEN_MOD)
  VALUES (sysdate, user, 'I', :NEW.ROW_ADDED_OPRID, :NEW.NRO_IDENTIDAD,:NEW.TIPO_IDENTIDAD, :new.AA_COD_ENTIDAD, :NEW.AA_SECUENCIA, :NEW.ROW_ADDED_DTTM,
         :NEW.ROW_ADDED_OPRID, :NEW.ROW_LASTMANT_DTTM, :NEW.ROW_LASTMANT_OPRID, :NEW.SYNCID, :NEW.SYNCDTTM,
         :NEW.AV_OFICINA_ADI, :NEW.AA_ORIGEN, :NEW.AV_OFICINA_MOD, :NEW.AA_ORIGEN_MOD);
  EXCEPTION WHEN Dup_Val_On_Index THEN NULL;

/* Fin 001 */
end AV_ENTI_OPRPN_I_TGR;

/
ALTER TRIGGER "DIVISAS"."AV_ENTI_OPRPN_I_TGR" ENABLE;
--------------------------------------------------------
--  DDL for Trigger AV_ENTI_OPRPN_U_TGR
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE TRIGGER "DIVISAS"."AV_ENTI_OPRPN_U_TGR" 
/* --------------------------------------------------------------------------------------
   AUTOR     FECHA        REF COMENTARIO
   GMARTRUS  23-OCT-2009  001 Trigger que peromite guardar el historial de la tabla
   CIMA                       PS_AA_ENTI_OPRPN.
   -------------------------------------------------------------------------------------- */
  before update on PS_AA_ENTI_OPRPN
  for each row
/* Inicio 001 */
Begin
  /* Se guarda el histoico de la tabla */
  Begin
    insert into PS_AV_ENTI_OPRPN_H
          (ACTIONDTTM, APPLIED_OPRID, AV_TIP_ACCION, APPLIED_OPRID2, NRO_IDENTIDAD,TIPO_IDENTIDAD, AA_COD_ENTIDAD, AA_SECUENCIA,
           ROW_ADDED_DTTM, ROW_ADDED_OPRID, ROW_LASTMANT_DTTM, ROW_LASTMANT_OPRID, SYNCID, SYNCDTTM,
           AV_OFICINA_ADI, AA_ORIGEN, AV_OFICINA_MOD, AA_ORIGEN_MOD)
    VALUES (sysdate, user, 'M', :NEW.ROW_LASTMANT_OPRID,:OLD.NRO_IDENTIDAD,:OLD.TIPO_IDENTIDAD, :OLD.AA_COD_ENTIDAD, :OLD.AA_SECUENCIA, :OLD.ROW_ADDED_DTTM,
           :OLD.ROW_ADDED_OPRID, :OLD.ROW_LASTMANT_DTTM, :OLD.ROW_LASTMANT_OPRID, :OLD.SYNCID, :OLD.SYNCDTTM,
           :OLD.AV_OFICINA_ADI, :OLD.AA_ORIGEN, :OLD.AV_OFICINA_MOD, :OLD.AA_ORIGEN_MOD);
    EXCEPTION WHEN Dup_Val_On_Index THEN NULL;
  end;
/* Fin 001 */
end AV_ENTI_OPRPN_U_TGR;

/
ALTER TRIGGER "DIVISAS"."AV_ENTI_OPRPN_U_TGR" ENABLE;
--------------------------------------------------------
--  DDL for Trigger AV_PJ_OPR_INTDT_D_TGR
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE TRIGGER "DIVISAS"."AV_PJ_OPR_INTDT_D_TGR" 
/* --------------------------------------------------------------------------------------
   AUTOR     FECHA        REF COMENTARIO
   GMARTRUS  22-OCT-2009  001 Trigger que peromite guardar el historial de la tabla
   CIMA                       PS_AA_PJ_OPR_INTDT.
   -------------------------------------------------------------------------------------- */
  before delete on PS_AA_PJ_OPR_INTDT
  for each row
/* Inicio 001 */
Begin
  /* Se guarda el histoico de la tabla */
  INSERT into PS_AV_PJ_O_INTDT_H
         (ACTIONDTTM, APPLIED_OPRID, AV_TIP_ACCION, APPLIED_OPRID2, SETID, NRO_IDENTIDAD,TIPO_IDENTIDAD,
          SEQ_NBR, AA_BANCO, AA_CIUDAD_OPR, CURRENCY_CD, AA_NRO_CUENTA, COUNTRY, AA_TIPO_CUENTA, AA_DIVISAS,
         AA_IMPORTACION, AA_EXPORTACION, AA_INVERSION, AA_GIROS, AA_ENVIO_GIROS, AA_SERVICIOS, AA_PRESTAMOS, AA_CTA_EXTERIOR,
         AA_MONTO_OPR, AA_MONTO_PROMEDIO, AA_MONTO_VENTA_OPR, AA_MONTO_PROM_VENT, CURRENCY_CD_BASE, AA_TOTAL_VENTA_USD,
         AA_TOTAL_VENTA_COP, AA_TOTAL_COMPR_USD, AA_TOTAL_COMPR_COP, AA_AUTORIZA_DIVISA, DATE_END, AA_SOPORTE_DIVISA,
         AA_TIPO_VIGENCIA, AA_BLOQUEO_DIVISAS, ROW_ADDED_DTTM, ROW_ADDED_OPRID, ROW_LASTMANT_DTTM,
         ROW_LASTMANT_OPRID, AV_OFICINA_ADI, AA_ORIGEN, AV_OFICINA_MOD, AA_ORIGEN_MOD)
  VALUES (sysdate, user, 'E', ' ',
         :OLD.SETID,:OLD.NRO_IDENTIDAD,:OLD.TIPO_IDENTIDAD,:OLD.SEQ_NBR, :OLD.AA_BANCO, :OLD.AA_CIUDAD_OPR,
         :OLD.CURRENCY_CD, :OLD.AA_NRO_CUENTA, :OLD.COUNTRY, :OLD.AA_TIPO_CUENTA, :OLD.AA_DIVISAS,
         :OLD.AA_IMPORTACION, :OLD.AA_EXPORTACION, :OLD.AA_INVERSION, :OLD.AA_GIROS, :OLD.AA_ENVIO_GIROS, :OLD.AA_SERVICIOS,
         :OLD.AA_PRESTAMOS, :OLD.AA_CTA_EXTERIOR,
         :OLD.AA_MONTO_OPR, :OLD.AA_MONTO_PROMEDIO, :OLD.AA_MONTO_VENTA_OPR, :OLD.AA_MONTO_PROM_VENT, :OLD.CURRENCY_CD_BASE,
         :OLD.AA_TOTAL_VENTA_USD,  :OLD.AA_TOTAL_VENTA_COP, :OLD.AA_TOTAL_COMPR_USD, :OLD.AA_TOTAL_COMPR_COP,
         :OLD.AA_AUTORIZA_DIVISA, :OLD.DATE_END, :OLD.AA_SOPORTE_DIVISA, :OLD.AA_TIPO_VIGENCIA, :OLD.AA_BLOQUEO_DIVISAS,
         :OLD.ROW_ADDED_DTTM, :OLD.ROW_ADDED_OPRID, :OLD.ROW_LASTMANT_DTTM, :OLD.ROW_LASTMANT_OPRID,
         :OLD.AV_OFICINA_ADI, :OLD.AA_ORIGEN, :OLD.AV_OFICINA_MOD, :OLD.AA_ORIGEN_MOD);
  EXCEPTION WHEN Dup_Val_On_Index THEN NULL;
/* Fin 001 */
end AV_PJ_OPR_INTDT_D_TGR;

/
ALTER TRIGGER "DIVISAS"."AV_PJ_OPR_INTDT_D_TGR" ENABLE;
--------------------------------------------------------
--  DDL for Trigger AV_PJ_OPR_INTDT_I_TGR
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE TRIGGER "DIVISAS"."AV_PJ_OPR_INTDT_I_TGR" 
/* --------------------------------------------------------------------------------------
   AUTOR     FECHA        REF COMENTARIO
   GMARTRUS  22-OCT-2009  001 Trigger que peromite guardar el historial de la tabla
   CIMA                       PS_AA_PJ_OPR_INTDT.
   -------------------------------------------------------------------------------------- */
  after insert on PS_AA_PJ_OPR_INTDT
  for each row
/* Inicio 001 */
Begin
  /* Se guarda el histoico de la tabla */
  INSERT into PS_AV_PJ_O_INTDT_H
         (ACTIONDTTM, APPLIED_OPRID, AV_TIP_ACCION, APPLIED_OPRID2, SETID,  NRO_IDENTIDAD,TIPO_IDENTIDAD,
         SEQ_NBR, AA_BANCO, AA_CIUDAD_OPR, CURRENCY_CD, AA_NRO_CUENTA, COUNTRY, AA_TIPO_CUENTA, AA_DIVISAS,
         AA_IMPORTACION, AA_EXPORTACION, AA_INVERSION, AA_GIROS, AA_ENVIO_GIROS, AA_SERVICIOS, AA_PRESTAMOS, AA_CTA_EXTERIOR,
         AA_MONTO_OPR, AA_MONTO_PROMEDIO, AA_MONTO_VENTA_OPR, AA_MONTO_PROM_VENT, CURRENCY_CD_BASE, AA_TOTAL_VENTA_USD,
         AA_TOTAL_VENTA_COP, AA_TOTAL_COMPR_USD, AA_TOTAL_COMPR_COP, AA_AUTORIZA_DIVISA, DATE_END, AA_SOPORTE_DIVISA,
         AA_TIPO_VIGENCIA, AA_BLOQUEO_DIVISAS, ROW_ADDED_DTTM, ROW_ADDED_OPRID, ROW_LASTMANT_DTTM,
         ROW_LASTMANT_OPRID, AV_OFICINA_ADI, AA_ORIGEN, AV_OFICINA_MOD, AA_ORIGEN_MOD)
  VALUES (sysdate, user, 'I', :NEW.ROW_ADDED_OPRID,
         :NEW.SETID, :NEW.NRO_IDENTIDAD,:NEW.TIPO_IDENTIDAD, :NEW.SEQ_NBR, :NEW.AA_BANCO, :NEW.AA_CIUDAD_OPR,
         :NEW.CURRENCY_CD, :NEW.AA_NRO_CUENTA, :NEW.COUNTRY, :NEW.AA_TIPO_CUENTA, :NEW.AA_DIVISAS,
         :NEW.AA_IMPORTACION, :NEW.AA_EXPORTACION, :NEW.AA_INVERSION, :NEW.AA_GIROS, :NEW.AA_ENVIO_GIROS, :NEW.AA_SERVICIOS,
         :NEW.AA_PRESTAMOS, :NEW.AA_CTA_EXTERIOR,
         :NEW.AA_MONTO_OPR, :NEW.AA_MONTO_PROMEDIO, :NEW.AA_MONTO_VENTA_OPR, :NEW.AA_MONTO_PROM_VENT, :NEW.CURRENCY_CD_BASE,
         :NEW.AA_TOTAL_VENTA_USD,  :NEW.AA_TOTAL_VENTA_COP, :NEW.AA_TOTAL_COMPR_USD, :NEW.AA_TOTAL_COMPR_COP,
         :NEW.AA_AUTORIZA_DIVISA, :NEW.DATE_END, :NEW.AA_SOPORTE_DIVISA, :NEW.AA_TIPO_VIGENCIA, :NEW.AA_BLOQUEO_DIVISAS,
         :NEW.ROW_ADDED_DTTM, :NEW.ROW_ADDED_OPRID, :NEW.ROW_LASTMANT_DTTM, :NEW.ROW_LASTMANT_OPRID,
         :NEW.AV_OFICINA_ADI, :NEW.AA_ORIGEN, :NEW.AV_OFICINA_MOD, :NEW.AA_ORIGEN_MOD);
  EXCEPTION WHEN Dup_Val_On_Index THEN NULL;
/* Fin 001 */
end AV_PJ_OPR_INTDT_I_TGR;

/
ALTER TRIGGER "DIVISAS"."AV_PJ_OPR_INTDT_I_TGR" ENABLE;
--------------------------------------------------------
--  DDL for Trigger AV_PJ_OPR_INTDT_U_TGR
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE TRIGGER "DIVISAS"."AV_PJ_OPR_INTDT_U_TGR" 
/* --------------------------------------------------------------------------------------
   AUTOR     FECHA        REF COMENTARIO
   GMARTRUS  22-OCT-2009  001 Trigger que peromite guardar el historial de la tabla
   CIMA                       PS_AA_PJ_OPR_INTDT.
   -------------------------------------------------------------------------------------- */
  before update on PS_AA_PJ_OPR_INTDT
  for each row
/* Inicio 001 */
Begin
  /* Se guarda el histoico de la tabla */
  Begin
    INSERT into PS_AV_PJ_O_INTDT_H
           (ACTIONDTTM, APPLIED_OPRID, AV_TIP_ACCION, APPLIED_OPRID2, SETID, NRO_IDENTIDAD,TIPO_IDENTIDAD, SEQ_NBR, AA_BANCO, AA_CIUDAD_OPR, CURRENCY_CD, AA_NRO_CUENTA, COUNTRY, AA_TIPO_CUENTA, AA_DIVISAS,
           AA_IMPORTACION, AA_EXPORTACION, AA_INVERSION, AA_GIROS, AA_ENVIO_GIROS, AA_SERVICIOS, AA_PRESTAMOS, AA_CTA_EXTERIOR,
           AA_MONTO_OPR, AA_MONTO_PROMEDIO, AA_MONTO_VENTA_OPR, AA_MONTO_PROM_VENT, CURRENCY_CD_BASE, AA_TOTAL_VENTA_USD,
           AA_TOTAL_VENTA_COP, AA_TOTAL_COMPR_USD, AA_TOTAL_COMPR_COP, AA_AUTORIZA_DIVISA, DATE_END, AA_SOPORTE_DIVISA,
           AA_TIPO_VIGENCIA, AA_BLOQUEO_DIVISAS, ROW_ADDED_DTTM, ROW_ADDED_OPRID, ROW_LASTMANT_DTTM,
           ROW_LASTMANT_OPRID, AV_OFICINA_ADI, AA_ORIGEN, AV_OFICINA_MOD, AA_ORIGEN_MOD)
    VALUES (sysdate, user, 'M', :NEW.ROW_LASTMANT_OPRID,
           :OLD.SETID,:OLD.NRO_IDENTIDAD,:OLD.TIPO_IDENTIDAD, :OLD.SEQ_NBR, :OLD.AA_BANCO, :OLD.AA_CIUDAD_OPR,
           :OLD.CURRENCY_CD, :OLD.AA_NRO_CUENTA, :OLD.COUNTRY, :OLD.AA_TIPO_CUENTA, :OLD.AA_DIVISAS,
           :OLD.AA_IMPORTACION, :OLD.AA_EXPORTACION, :OLD.AA_INVERSION, :OLD.AA_GIROS, :OLD.AA_ENVIO_GIROS, :OLD.AA_SERVICIOS,
           :OLD.AA_PRESTAMOS, :OLD.AA_CTA_EXTERIOR,
           :OLD.AA_MONTO_OPR, :OLD.AA_MONTO_PROMEDIO, :OLD.AA_MONTO_VENTA_OPR, :OLD.AA_MONTO_PROM_VENT, :OLD.CURRENCY_CD_BASE,
           :OLD.AA_TOTAL_VENTA_USD,  :OLD.AA_TOTAL_VENTA_COP, :OLD.AA_TOTAL_COMPR_USD, :OLD.AA_TOTAL_COMPR_COP,
           :OLD.AA_AUTORIZA_DIVISA, :OLD.DATE_END, :OLD.AA_SOPORTE_DIVISA, :OLD.AA_TIPO_VIGENCIA, :OLD.AA_BLOQUEO_DIVISAS,
           :OLD.ROW_ADDED_DTTM, :OLD.ROW_ADDED_OPRID, :OLD.ROW_LASTMANT_DTTM, :OLD.ROW_LASTMANT_OPRID,
           :OLD.AV_OFICINA_ADI, :OLD.AA_ORIGEN, :OLD.AV_OFICINA_MOD, :OLD.AA_ORIGEN_MOD);
    EXCEPTION WHEN Dup_Val_On_Index THEN NULL;
  end;
/* Fin 001 */
end AV_PJ_OPR_INTDT_U_TGR;

/
ALTER TRIGGER "DIVISAS"."AV_PJ_OPR_INTDT_U_TGR" ENABLE;
--------------------------------------------------------
--  DDL for Trigger AV_PJ_OPR_INTER_D_TGR
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE TRIGGER "DIVISAS"."AV_PJ_OPR_INTER_D_TGR" 
/* --------------------------------------------------------------------------------------
   AUTOR     FECHA        REF COMENTARIO
   GMARTRUS  22-OCT-2009  001 Trigger que peromite guardar el historial de la tabla
   CIMA                       PS_AA_PJ_OPR_INTER.
   -------------------------------------------------------------------------------------- */
  before delete on PS_AA_PJ_OPR_INTER
  for each row
/* Inicio 001 */
Begin
  /* Se guarda el histoico de la tabla */
  INSERT into PS_AV_PJ_O_INTER_H
         (ACTIONDTTM, APPLIED_OPRID, AV_TIP_ACCION, APPLIED_OPRID2,
         SETID,NRO_IDENTIDAD,TIPO_IDENTIDAD, AA_BANCO, AA_CIUDAD_OPR, CURRENCY_CD, AA_NRO_CUENTA, COUNTRY, AA_TIPO_CUENTA, AA_DIVISAS,
         AA_IMPORTACION, AA_EXPORTACION, AA_INVERSION, AA_GIROS, AA_ENVIO_GIROS, AA_SERVICIOS, AA_PRESTAMOS, AA_CTA_EXTERIOR,
         AA_MONTO_OPR, AA_MONTO_PROMEDIO, AA_MONTO_VENTA_OPR, AA_MONTO_PROM_VENT, CURRENCY_CD_BASE, AA_TOTAL_VENTA_USD,
         AA_TOTAL_VENTA_COP, AA_TOTAL_COMPR_USD, AA_TOTAL_COMPR_COP, AA_AUTORIZA_DIVISA, DATE_END, ROW_LASTMANT_DTTM,
         ROW_LASTMANT_OPRID, AA_SALDO_DISPON, AA_TIPO_CUENT_CUAL, AA_FUNC_AUTORIZA, AA_SALDO_FIN,
         ROW_ADDED_DTTM, ROW_ADDED_OPRID, AV_OFICINA_ADI, AA_ORIGEN, AV_OFICINA_MOD, AA_ORIGEN_MOD)
  VALUES (sysdate, user, 'E', ' ',
         :OLD.SETID,:OLD.NRO_IDENTIDAD,:OLD.TIPO_IDENTIDAD, :OLD.AA_BANCO, :OLD.AA_CIUDAD_OPR, :OLD.CURRENCY_CD,
         :OLD.AA_NRO_CUENTA, :OLD.COUNTRY, :OLD.AA_TIPO_CUENTA, :OLD.AA_DIVISAS,
         :OLD.AA_IMPORTACION, :OLD.AA_EXPORTACION, :OLD.AA_INVERSION, :OLD.AA_GIROS, :OLD.AA_ENVIO_GIROS, :OLD.AA_SERVICIOS,
         :OLD.AA_PRESTAMOS, :OLD.AA_CTA_EXTERIOR,
         :OLD.AA_MONTO_OPR, :OLD.AA_MONTO_PROMEDIO, :OLD.AA_MONTO_VENTA_OPR, :OLD.AA_MONTO_PROM_VENT, :OLD.CURRENCY_CD_BASE,
         :OLD.AA_TOTAL_VENTA_USD,  :OLD.AA_TOTAL_VENTA_COP, :OLD.AA_TOTAL_COMPR_USD, :OLD.AA_TOTAL_COMPR_COP,
         :OLD.AA_AUTORIZA_DIVISA, :OLD.DATE_END, :OLD.ROW_LASTMANT_DTTM, :OLD.ROW_LASTMANT_OPRID, :OLD.AA_SALDO_DISPON,
         :OLD.AA_TIPO_CUENT_CUAL, :OLD.AA_FUNC_AUTORIZA, :OLD.AA_SALDO_FIN,
         :OLD.ROW_ADDED_DTTM, :OLD.ROW_ADDED_OPRID,
         :OLD.AV_OFICINA_ADI, :OLD.AA_ORIGEN, :OLD.AV_OFICINA_MOD, :OLD.AA_ORIGEN_MOD);
  EXCEPTION WHEN Dup_Val_On_Index THEN NULL;
/* Fin 001 */
end AV_PJ_OPR_INTER_D_TGR;

/
ALTER TRIGGER "DIVISAS"."AV_PJ_OPR_INTER_D_TGR" ENABLE;
--------------------------------------------------------
--  DDL for Trigger AV_PJ_OPR_INTER_I_TGR
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE TRIGGER "DIVISAS"."AV_PJ_OPR_INTER_I_TGR" 
/* --------------------------------------------------------------------------------------
   AUTOR     FECHA        REF COMENTARIO
   GMARTRUS  22-OCT-2009  001 Trigger que peromite guardar el historial de la tabla
   CIMA                       PS_AA_PJ_OPR_INTER.
   -------------------------------------------------------------------------------------- */
  after insert on PS_AA_PJ_OPR_INTER
  for each row
/* Inicio 001 */
Begin
  /* Se guarda el histoico de la tabla */
  INSERT into PS_AV_PJ_O_INTER_H
         (ACTIONDTTM, APPLIED_OPRID, AV_TIP_ACCION, APPLIED_OPRID2,
         SETID, NRO_IDENTIDAD,TIPO_IDENTIDAD, AA_BANCO, AA_CIUDAD_OPR, CURRENCY_CD, AA_NRO_CUENTA, COUNTRY, AA_TIPO_CUENTA, AA_DIVISAS,
         AA_IMPORTACION, AA_EXPORTACION, AA_INVERSION, AA_GIROS, AA_ENVIO_GIROS, AA_SERVICIOS, AA_PRESTAMOS, AA_CTA_EXTERIOR,
         AA_MONTO_OPR, AA_MONTO_PROMEDIO, AA_MONTO_VENTA_OPR, AA_MONTO_PROM_VENT, CURRENCY_CD_BASE, AA_TOTAL_VENTA_USD,
         AA_TOTAL_VENTA_COP, AA_TOTAL_COMPR_USD, AA_TOTAL_COMPR_COP, AA_AUTORIZA_DIVISA, DATE_END, ROW_LASTMANT_DTTM,
         ROW_LASTMANT_OPRID, AA_SALDO_DISPON, AA_TIPO_CUENT_CUAL, AA_FUNC_AUTORIZA, AA_SALDO_FIN,
         ROW_ADDED_DTTM, ROW_ADDED_OPRID, AV_OFICINA_ADI, AA_ORIGEN, AV_OFICINA_MOD, AA_ORIGEN_MOD)
  VALUES (sysdate, user, 'I', :NEW.ROW_ADDED_OPRID,
         :NEW.SETID,:NEW.NRO_IDENTIDAD,:NEW.TIPO_IDENTIDAD, :NEW.AA_BANCO, :NEW.AA_CIUDAD_OPR, :NEW.CURRENCY_CD,
         :NEW.AA_NRO_CUENTA, :NEW.COUNTRY, :NEW.AA_TIPO_CUENTA, :NEW.AA_DIVISAS,
         :NEW.AA_IMPORTACION, :NEW.AA_EXPORTACION, :NEW.AA_INVERSION, :NEW.AA_GIROS, :NEW.AA_ENVIO_GIROS, :NEW.AA_SERVICIOS,
         :NEW.AA_PRESTAMOS, :NEW.AA_CTA_EXTERIOR,
         :NEW.AA_MONTO_OPR, :NEW.AA_MONTO_PROMEDIO, :NEW.AA_MONTO_VENTA_OPR, :NEW.AA_MONTO_PROM_VENT, :NEW.CURRENCY_CD_BASE,
         :NEW.AA_TOTAL_VENTA_USD,  :NEW.AA_TOTAL_VENTA_COP, :NEW.AA_TOTAL_COMPR_USD, :NEW.AA_TOTAL_COMPR_COP,
         :NEW.AA_AUTORIZA_DIVISA, :NEW.DATE_END, :NEW.ROW_LASTMANT_DTTM, :NEW.ROW_LASTMANT_OPRID, :NEW.AA_SALDO_DISPON,
         :NEW.AA_TIPO_CUENT_CUAL, :NEW.AA_FUNC_AUTORIZA, :NEW.AA_SALDO_FIN,
         :NEW.ROW_ADDED_DTTM, :NEW.ROW_ADDED_OPRID,
         :NEW.AV_OFICINA_ADI, :NEW.AA_ORIGEN, :NEW.AV_OFICINA_MOD, :NEW.AA_ORIGEN_MOD);
  EXCEPTION WHEN Dup_Val_On_Index THEN NULL;
/* Fin 001 */
end AV_PJ_OPR_INTER_I_TGR;

/
ALTER TRIGGER "DIVISAS"."AV_PJ_OPR_INTER_I_TGR" ENABLE;
--------------------------------------------------------
--  DDL for Trigger AV_PJ_OPR_INTER_U_TGR
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE TRIGGER "DIVISAS"."AV_PJ_OPR_INTER_U_TGR" 
/* --------------------------------------------------------------------------------------
   AUTOR     FECHA        REF COMENTARIO
   GMARTRUS  22-OCT-2009  001 Trigger que peromite guardar el historial de la tabla
   CIMA                       PS_AA_PJ_OPR_INTER.
   -------------------------------------------------------------------------------------- */
  before update on PS_AA_PJ_OPR_INTER
  for each row
/* Inicio 001 */
Begin
  /* Se guarda el histoico de la tabla */
  Begin
    INSERT into PS_AV_PJ_O_INTER_H
           (ACTIONDTTM, APPLIED_OPRID, AV_TIP_ACCION, APPLIED_OPRID2,
           SETID, NRO_IDENTIDAD,TIPO_IDENTIDAD, AA_BANCO, AA_CIUDAD_OPR, CURRENCY_CD, AA_NRO_CUENTA, COUNTRY, AA_TIPO_CUENTA, AA_DIVISAS,
           AA_IMPORTACION, AA_EXPORTACION, AA_INVERSION, AA_GIROS, AA_ENVIO_GIROS, AA_SERVICIOS, AA_PRESTAMOS, AA_CTA_EXTERIOR,
           AA_MONTO_OPR, AA_MONTO_PROMEDIO, AA_MONTO_VENTA_OPR, AA_MONTO_PROM_VENT, CURRENCY_CD_BASE, AA_TOTAL_VENTA_USD,
           AA_TOTAL_VENTA_COP, AA_TOTAL_COMPR_USD, AA_TOTAL_COMPR_COP, AA_AUTORIZA_DIVISA, DATE_END, ROW_LASTMANT_DTTM,
           ROW_LASTMANT_OPRID, AA_SALDO_DISPON, AA_TIPO_CUENT_CUAL, AA_FUNC_AUTORIZA, AA_SALDO_FIN,
           ROW_ADDED_DTTM, ROW_ADDED_OPRID, AV_OFICINA_ADI, AA_ORIGEN, AV_OFICINA_MOD, AA_ORIGEN_MOD)
    VALUES (sysdate, user, 'M', :NEW.ROW_LASTMANT_OPRID,
           :OLD.SETID, :OLD.NRO_IDENTIDAD,:OLD.TIPO_IDENTIDAD, :OLD.AA_BANCO, :OLD.AA_CIUDAD_OPR, :OLD.CURRENCY_CD,
           :OLD.AA_NRO_CUENTA, :OLD.COUNTRY, :OLD.AA_TIPO_CUENTA, :OLD.AA_DIVISAS,
           :OLD.AA_IMPORTACION, :OLD.AA_EXPORTACION, :OLD.AA_INVERSION, :OLD.AA_GIROS, :OLD.AA_ENVIO_GIROS, :OLD.AA_SERVICIOS,
           :OLD.AA_PRESTAMOS, :OLD.AA_CTA_EXTERIOR,
           :OLD.AA_MONTO_OPR, :OLD.AA_MONTO_PROMEDIO, :OLD.AA_MONTO_VENTA_OPR, :OLD.AA_MONTO_PROM_VENT, :OLD.CURRENCY_CD_BASE,
           :OLD.AA_TOTAL_VENTA_USD,  :OLD.AA_TOTAL_VENTA_COP, :OLD.AA_TOTAL_COMPR_USD, :OLD.AA_TOTAL_COMPR_COP,
           :OLD.AA_AUTORIZA_DIVISA, :OLD.DATE_END, :OLD.ROW_LASTMANT_DTTM, :OLD.ROW_LASTMANT_OPRID, :OLD.AA_SALDO_DISPON,
           :OLD.AA_TIPO_CUENT_CUAL, :OLD.AA_FUNC_AUTORIZA, :OLD.AA_SALDO_FIN,
           :OLD.ROW_ADDED_DTTM, :OLD.ROW_ADDED_OPRID,
           :OLD.AV_OFICINA_ADI, :OLD.AA_ORIGEN, :OLD.AV_OFICINA_MOD, :OLD.AA_ORIGEN_MOD);
   EXCEPTION WHEN Dup_Val_On_Index THEN NULL;
  end;
/* Fin 001 */
end AV_PJ_OPR_INTER_U_TGR;

/
ALTER TRIGGER "DIVISAS"."AV_PJ_OPR_INTER_U_TGR" ENABLE;
--------------------------------------------------------
--  DDL for Trigger AV_PN_OPR_INTDT_D_TGR
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE TRIGGER "DIVISAS"."AV_PN_OPR_INTDT_D_TGR" 
/* --------------------------------------------------------------------------------------
   AUTOR     FECHA        REF COMENTARIO
   GMARTRUS  21-OCT-2009  001 Trigger que peromite guardar el historial de la tabla
   CIMA                       PS_AA_PN_OPR_INTDT.
   -------------------------------------------------------------------------------------- */
  before delete on PS_AA_PN_OPR_INTDT
  for each row
/* Inicio 001 */
Begin
  /* Se guarda el histoico de la tabla */
  INSERT into PS_AV_PN_O_INTDT_H
         (ACTIONDTTM, APPLIED_OPRID, AV_TIP_ACCION, APPLIED_OPRID2, NRO_IDENTIDAD,TIPO_IDENTIDAD, SEQ_NBR,
         AA_CIUDAD_OPR, AA_ENTIDAD_OPR, CURRENCY_CD, CURRENCY_CD_BASE, AA_AUTORIZA_DIVISA,
         DATE_END, AA_TOTAL_VENTA_USD, AA_TOTAL_VENTA_COP, AA_TOTAL_COMPR_USD, AA_TOTAL_COMPR_COP,
         AA_NRO_CUENTA, COUNTRY, AA_TIPO_CUENTA, AA_DIVISAS,
         AA_IMPORTACION, AA_EXPORTACION, AA_INVERSION, AA_GIROS, AA_ENVIO_GIROS, AA_SERVICIOS,
         AA_PRESTAMOS, AA_CTA_EXTERIOR, AA_MONTO_OPR, AA_MONTO_PROMEDIO, AA_MONTO_VENTA_OPR,
         AA_MONTO_PROM_VENT, AA_SOPORTE_DIVISA, AA_TIPO_VIGENCIA,
         AA_SALDO_DISPON, AA_BLOQUEO_DIVISAS,
         ROW_ADDED_DTTM, ROW_ADDED_OPRID, ROW_LASTMANT_DTTM, ROW_LASTMANT_OPRID, AV_OFICINA_ADI,
         AA_ORIGEN, AV_OFICINA_MOD, AA_ORIGEN_MOD)
  VALUES (sysdate, user, 'E', ' ', :OLD.NRO_IDENTIDAD,:OLD.TIPO_IDENTIDAD, :OLD.SEQ_NBR,:OLD.AA_CIUDAD_OPR, :OLD.AA_ENTIDAD_OPR,
         :OLD.CURRENCY_CD, :OLD.CURRENCY_CD_BASE, :OLD.AA_AUTORIZA_DIVISA, :OLD.DATE_END,
         :OLD.AA_TOTAL_VENTA_USD, :OLD.AA_TOTAL_VENTA_COP, :OLD.AA_TOTAL_COMPR_USD, :OLD.AA_TOTAL_COMPR_COP,
         :OLD.AA_NRO_CUENTA, :OLD.COUNTRY, :OLD.AA_TIPO_CUENTA,
         :OLD.AA_DIVISAS, :OLD.AA_IMPORTACION, :OLD.AA_EXPORTACION, :OLD.AA_INVERSION, :OLD.AA_GIROS,
         :OLD.AA_ENVIO_GIROS, :OLD.AA_SERVICIOS, :OLD.AA_PRESTAMOS, :OLD.AA_CTA_EXTERIOR, :OLD.AA_MONTO_OPR,
         :OLD.AA_MONTO_PROMEDIO, :OLD.AA_MONTO_VENTA_OPR, :OLD.AA_MONTO_PROM_VENT, :OLD.AA_SOPORTE_DIVISA,
         :OLD.AA_TIPO_VIGENCIA, :OLD.AA_SALDO_DISPON, :OLD.AA_BLOQUEO_DIVISAS,
         :OLD.ROW_ADDED_DTTM, :OLD.ROW_ADDED_OPRID, :OLD.ROW_LASTMANT_DTTM, :OLD.ROW_LASTMANT_OPRID,
         :OLD.AV_OFICINA_ADI, :OLD.AA_ORIGEN, :OLD.AV_OFICINA_MOD, :OLD.AA_ORIGEN_MOD);
  EXCEPTION WHEN Dup_Val_On_Index THEN NULL;
/* Fin 001 */
end AV_PN_OPR_INTDT_D_TGR;

/
ALTER TRIGGER "DIVISAS"."AV_PN_OPR_INTDT_D_TGR" ENABLE;
--------------------------------------------------------
--  DDL for Trigger AV_PN_OPR_INTDT_I_TGR
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE TRIGGER "DIVISAS"."AV_PN_OPR_INTDT_I_TGR" 
/* --------------------------------------------------------------------------------------
   AUTOR     FECHA        REF COMENTARIO
   GMARTRUS  21-OCT-2009  001 Trigger que peromite guardar el historial de la tabla
   CIMA                       PS_AA_PN_OPR_INTDT.
   -------------------------------------------------------------------------------------- */
  after insert on PS_AA_PN_OPR_INTDT
  for each row
/* Inicio 001 */
Begin
  /* Se guarda el histoico de la tabla */
  INSERT into PS_AV_PN_O_INTDT_H
         (ACTIONDTTM, APPLIED_OPRID, AV_TIP_ACCION, APPLIED_OPRID2,NRO_IDENTIDAD,TIPO_IDENTIDAD, SEQ_NBR,
         AA_CIUDAD_OPR, AA_ENTIDAD_OPR, CURRENCY_CD, CURRENCY_CD_BASE, AA_AUTORIZA_DIVISA,
         DATE_END, AA_TOTAL_VENTA_USD, AA_TOTAL_VENTA_COP, AA_TOTAL_COMPR_USD, AA_TOTAL_COMPR_COP,
         AA_NRO_CUENTA, COUNTRY, AA_TIPO_CUENTA, AA_DIVISAS,
         AA_IMPORTACION, AA_EXPORTACION, AA_INVERSION, AA_GIROS, AA_ENVIO_GIROS, AA_SERVICIOS,
         AA_PRESTAMOS, AA_CTA_EXTERIOR, AA_MONTO_OPR, AA_MONTO_PROMEDIO, AA_MONTO_VENTA_OPR,
         AA_MONTO_PROM_VENT, AA_SOPORTE_DIVISA, AA_TIPO_VIGENCIA,
         AA_SALDO_DISPON, AA_BLOQUEO_DIVISAS,
         ROW_ADDED_DTTM, ROW_ADDED_OPRID, ROW_LASTMANT_DTTM, ROW_LASTMANT_OPRID, AV_OFICINA_ADI,
         AA_ORIGEN, AV_OFICINA_MOD, AA_ORIGEN_MOD)
  VALUES (sysdate, user, 'I', :NEW.ROW_ADDED_OPRID,
         :NEW.NRO_IDENTIDAD,:NEW.TIPO_IDENTIDAD, :NEW.SEQ_NBR, :NEW.AA_CIUDAD_OPR, :NEW.AA_ENTIDAD_OPR,
         :NEW.CURRENCY_CD, :NEW.CURRENCY_CD_BASE, :NEW.AA_AUTORIZA_DIVISA, :NEW.DATE_END,
         :NEW.AA_TOTAL_VENTA_USD, :NEW.AA_TOTAL_VENTA_COP, :NEW.AA_TOTAL_COMPR_USD, :NEW.AA_TOTAL_COMPR_COP,
         :NEW.AA_NRO_CUENTA, :NEW.COUNTRY, :NEW.AA_TIPO_CUENTA,
         :NEW.AA_DIVISAS, :NEW.AA_IMPORTACION, :NEW.AA_EXPORTACION, :NEW.AA_INVERSION, :NEW.AA_GIROS,
         :NEW.AA_ENVIO_GIROS, :NEW.AA_SERVICIOS, :NEW.AA_PRESTAMOS, :NEW.AA_CTA_EXTERIOR, :NEW.AA_MONTO_OPR,
         :NEW.AA_MONTO_PROMEDIO, :NEW.AA_MONTO_VENTA_OPR, :NEW.AA_MONTO_PROM_VENT, :NEW.AA_SOPORTE_DIVISA,
         :NEW.AA_TIPO_VIGENCIA, :NEW.AA_SALDO_DISPON, :NEW.AA_BLOQUEO_DIVISAS,
         :NEW.ROW_ADDED_DTTM, :NEW.ROW_ADDED_OPRID, :NEW.ROW_LASTMANT_DTTM, :NEW.ROW_LASTMANT_OPRID,
         :NEW.AV_OFICINA_ADI, :NEW.AA_ORIGEN, :NEW.AV_OFICINA_MOD, :NEW.AA_ORIGEN_MOD);
  EXCEPTION WHEN Dup_Val_On_Index THEN NULL;
/* Fin 001 */
end AV_PN_OPR_INTDT_I_TGR;

/
ALTER TRIGGER "DIVISAS"."AV_PN_OPR_INTDT_I_TGR" ENABLE;
--------------------------------------------------------
--  DDL for Trigger AV_PN_OPR_INTDT_U_TGR
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE TRIGGER "DIVISAS"."AV_PN_OPR_INTDT_U_TGR" 
/* --------------------------------------------------------------------------------------
   AUTOR     FECHA        REF COMENTARIO
   GMARTRUS  21-OCT-2009  001 Trigger que peromite guardar el historial de la tabla
   CIMA                       PS_AA_PN_OPR_INTDT.
   -------------------------------------------------------------------------------------- */
  before update on PS_AA_PN_OPR_INTDT
  for each row
/* Inicio 001 */
Begin
  /* Se guarda el histoico de la tabla */
  Begin
    INSERT into PS_AV_PN_O_INTDT_H
           (ACTIONDTTM, APPLIED_OPRID, AV_TIP_ACCION, APPLIED_OPRID2,NRO_IDENTIDAD,TIPO_IDENTIDAD, SEQ_NBR,
           AA_CIUDAD_OPR, AA_ENTIDAD_OPR, CURRENCY_CD, CURRENCY_CD_BASE, AA_AUTORIZA_DIVISA,
           DATE_END, AA_TOTAL_VENTA_USD, AA_TOTAL_VENTA_COP, AA_TOTAL_COMPR_USD, AA_TOTAL_COMPR_COP,
           AA_NRO_CUENTA, COUNTRY, AA_TIPO_CUENTA, AA_DIVISAS,
           AA_IMPORTACION, AA_EXPORTACION, AA_INVERSION, AA_GIROS, AA_ENVIO_GIROS, AA_SERVICIOS,
           AA_PRESTAMOS, AA_CTA_EXTERIOR, AA_MONTO_OPR, AA_MONTO_PROMEDIO, AA_MONTO_VENTA_OPR,
           AA_MONTO_PROM_VENT, AA_SOPORTE_DIVISA, AA_TIPO_VIGENCIA,
           AA_SALDO_DISPON, AA_BLOQUEO_DIVISAS,
           ROW_ADDED_DTTM, ROW_ADDED_OPRID, ROW_LASTMANT_DTTM, ROW_LASTMANT_OPRID, AV_OFICINA_ADI,
           AA_ORIGEN, AV_OFICINA_MOD, AA_ORIGEN_MOD)
    VALUES (sysdate, user, 'M', :NEW.ROW_LASTMANT_OPRID,
           :OLD.NRO_IDENTIDAD,:OLD.TIPO_IDENTIDAD, :OLD.SEQ_NBR, :OLD.AA_CIUDAD_OPR, :OLD.AA_ENTIDAD_OPR,
           :OLD.CURRENCY_CD, :OLD.CURRENCY_CD_BASE, :OLD.AA_AUTORIZA_DIVISA, :OLD.DATE_END,
           :OLD.AA_TOTAL_VENTA_USD, :OLD.AA_TOTAL_VENTA_COP, :OLD.AA_TOTAL_COMPR_USD, :OLD.AA_TOTAL_COMPR_COP,
           :OLD.AA_NRO_CUENTA, :OLD.COUNTRY, :OLD.AA_TIPO_CUENTA,
           :OLD.AA_DIVISAS, :OLD.AA_IMPORTACION, :OLD.AA_EXPORTACION, :OLD.AA_INVERSION, :OLD.AA_GIROS,
           :OLD.AA_ENVIO_GIROS, :OLD.AA_SERVICIOS, :OLD.AA_PRESTAMOS, :OLD.AA_CTA_EXTERIOR, :OLD.AA_MONTO_OPR,
           :OLD.AA_MONTO_PROMEDIO, :OLD.AA_MONTO_VENTA_OPR, :OLD.AA_MONTO_PROM_VENT, :OLD.AA_SOPORTE_DIVISA,
           :OLD.AA_TIPO_VIGENCIA, :OLD.AA_SALDO_DISPON, :OLD.AA_BLOQUEO_DIVISAS,
           :OLD.ROW_ADDED_DTTM, :OLD.ROW_ADDED_OPRID, :OLD.ROW_LASTMANT_DTTM, :OLD.ROW_LASTMANT_OPRID,
           :OLD.AV_OFICINA_ADI, :OLD.AA_ORIGEN, :OLD.AV_OFICINA_MOD, :OLD.AA_ORIGEN_MOD);
    EXCEPTION WHEN Dup_Val_On_Index THEN NULL;
  end;
/* Fin 001 */
  end AV_PN_OPR_INTDT_U_TGR;

/
ALTER TRIGGER "DIVISAS"."AV_PN_OPR_INTDT_U_TGR" ENABLE;
--------------------------------------------------------
--  DDL for Trigger AV_PN_OPR_INTER_D_TGR
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE TRIGGER "DIVISAS"."AV_PN_OPR_INTER_D_TGR" 
/* --------------------------------------------------------------------------------------
   AUTOR     FECHA        REF COMENTARIO
   GMARTRUS  21-OCT-2009  001 Trigger que peromite guardar el historial de la tabla
   CIMA                       PS_AA_PN_OPR_INTER.
   -------------------------------------------------------------------------------------- */
  before delete on PS_AA_PN_OPR_INTER
  for each row
/* Inicio 001 */
Begin
  /* Se guarda el histoico de la tabla */
  INSERT into PS_AV_PN_O_INTER_H
         (ACTIONDTTM, APPLIED_OPRID, AV_TIP_ACCION, APPLIED_OPRID2, NRO_IDENTIDAD,TIPO_IDENTIDAD,
         AA_CIUDAD_OPR, AA_ENTIDAD_OPR, CURRENCY_CD, CURRENCY_CD_BASE, AA_AUTORIZA_DIVISA,
         DATE_END, AA_TOTAL_VENTA_USD, AA_TOTAL_VENTA_COP, AA_TOTAL_COMPR_USD, AA_TOTAL_COMPR_COP,
         ROW_LASTMANT_DTTM, ROW_LASTMANT_OPRID, AA_NRO_CUENTA, COUNTRY, AA_TIPO_CUENTA, AA_DIVISAS,
         AA_IMPORTACION, AA_EXPORTACION, AA_INVERSION, AA_GIROS, AA_ENVIO_GIROS, AA_SERVICIOS,
         AA_PRESTAMOS, AA_CTA_EXTERIOR, AA_MONTO_OPR, AA_MONTO_PROMEDIO, AA_MONTO_VENTA_OPR,
         AA_MONTO_PROM_VENT, AA_SALDO_DISPON, AA_TIPO_CUENT_CUAL, AA_FUNC_AUTORIZA, AA_SALDO_FIN,
         AA_COD_OFICINA, AA_COD_OFICINA_MOD, ROW_ADDED_DTTM, ROW_ADDED_OPRID, AV_OFICINA_ADI,
         AA_ORIGEN, AV_OFICINA_MOD, AA_ORIGEN_MOD)
  VALUES (sysdate, user, 'E', ' ',  :OLD.NRO_IDENTIDAD,:OLD.TIPO_IDENTIDAD, :OLD.AA_CIUDAD_OPR, :OLD.AA_ENTIDAD_OPR,
         :OLD.CURRENCY_CD, :OLD.CURRENCY_CD_BASE, :OLD.AA_AUTORIZA_DIVISA, :OLD.DATE_END,
         :OLD.AA_TOTAL_VENTA_USD, :OLD.AA_TOTAL_VENTA_COP, :OLD.AA_TOTAL_COMPR_USD, :OLD.AA_TOTAL_COMPR_COP,
         :OLD.ROW_LASTMANT_DTTM, :OLD.ROW_LASTMANT_OPRID, :OLD.AA_NRO_CUENTA, :OLD.COUNTRY, :OLD.AA_TIPO_CUENTA,
         :OLD.AA_DIVISAS, :OLD.AA_IMPORTACION, :OLD.AA_EXPORTACION, :OLD.AA_INVERSION, :OLD.AA_GIROS,
         :OLD.AA_ENVIO_GIROS, :OLD.AA_SERVICIOS, :OLD.AA_PRESTAMOS, :OLD.AA_CTA_EXTERIOR, :OLD.AA_MONTO_OPR,
         :OLD.AA_MONTO_PROMEDIO, :OLD.AA_MONTO_VENTA_OPR, :OLD.AA_MONTO_PROM_VENT, :OLD.AA_SALDO_DISPON,
         :OLD.AA_TIPO_CUENT_CUAL, :OLD.AA_FUNC_AUTORIZA, :OLD.AA_SALDO_FIN,
         :OLD.AA_COD_OFICINA, :OLD.AA_COD_OFICINA_MOD, :OLD.ROW_ADDED_DTTM, :OLD.ROW_ADDED_OPRID,
         :OLD.AV_OFICINA_ADI, :OLD.AA_ORIGEN, :OLD.AV_OFICINA_MOD, :OLD.AA_ORIGEN_MOD);
  EXCEPTION WHEN Dup_Val_On_Index THEN NULL;
/* Fin 001 */
end AV_PN_OPR_INTER_D_TGR;

/
ALTER TRIGGER "DIVISAS"."AV_PN_OPR_INTER_D_TGR" ENABLE;
--------------------------------------------------------
--  DDL for Trigger AV_PN_OPR_INTER_I_TGR
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE TRIGGER "DIVISAS"."AV_PN_OPR_INTER_I_TGR" 
/* --------------------------------------------------------------------------------------
   AUTOR     FECHA        REF COMENTARIO
   GMARTRUS  21-OCT-2009  001 Trigger que peromite guardar el historial de la tabla
   CIMA                       PS_AA_PN_OPR_INTER.
   -------------------------------------------------------------------------------------- */
  after insert on PS_AA_PN_OPR_INTER
  for each row
/* Inicio 001 */
Begin
  /* Se guarda el histoico de la tabla */
  INSERT into PS_AV_PN_O_INTER_H
         (ACTIONDTTM, APPLIED_OPRID, AV_TIP_ACCION, APPLIED_OPRID2, NRO_IDENTIDAD,TIPO_IDENTIDAD,
         AA_CIUDAD_OPR, AA_ENTIDAD_OPR, CURRENCY_CD, CURRENCY_CD_BASE, AA_AUTORIZA_DIVISA,
         DATE_END, AA_TOTAL_VENTA_USD, AA_TOTAL_VENTA_COP, AA_TOTAL_COMPR_USD, AA_TOTAL_COMPR_COP,
         ROW_LASTMANT_DTTM, ROW_LASTMANT_OPRID, AA_NRO_CUENTA, COUNTRY, AA_TIPO_CUENTA, AA_DIVISAS,
         AA_IMPORTACION, AA_EXPORTACION, AA_INVERSION, AA_GIROS, AA_ENVIO_GIROS, AA_SERVICIOS,
         AA_PRESTAMOS, AA_CTA_EXTERIOR, AA_MONTO_OPR, AA_MONTO_PROMEDIO, AA_MONTO_VENTA_OPR,
         AA_MONTO_PROM_VENT, AA_SALDO_DISPON, AA_TIPO_CUENT_CUAL, AA_FUNC_AUTORIZA, AA_SALDO_FIN,
         AA_COD_OFICINA, AA_COD_OFICINA_MOD, ROW_ADDED_DTTM, ROW_ADDED_OPRID, AV_OFICINA_ADI,
         AA_ORIGEN, AV_OFICINA_MOD, AA_ORIGEN_MOD)
  VALUES (sysdate, user, 'I', :NEW.ROW_ADDED_OPRID,:NEW.NRO_IDENTIDAD,:NEW.TIPO_IDENTIDAD,
         :NEW.AA_CIUDAD_OPR, :NEW.AA_ENTIDAD_OPR,
         :NEW.CURRENCY_CD, :NEW.CURRENCY_CD_BASE, :NEW.AA_AUTORIZA_DIVISA, :NEW.DATE_END,
         :NEW.AA_TOTAL_VENTA_USD, :NEW.AA_TOTAL_VENTA_COP, :NEW.AA_TOTAL_COMPR_USD, :NEW.AA_TOTAL_COMPR_COP,
         :NEW.ROW_LASTMANT_DTTM, :NEW.ROW_LASTMANT_OPRID, :NEW.AA_NRO_CUENTA, :NEW.COUNTRY, :NEW.AA_TIPO_CUENTA,
         :NEW.AA_DIVISAS, :NEW.AA_IMPORTACION, :NEW.AA_EXPORTACION, :NEW.AA_INVERSION, :NEW.AA_GIROS,
         :NEW.AA_ENVIO_GIROS, :NEW.AA_SERVICIOS, :NEW.AA_PRESTAMOS, :NEW.AA_CTA_EXTERIOR, :NEW.AA_MONTO_OPR,
         :NEW.AA_MONTO_PROMEDIO, :NEW.AA_MONTO_VENTA_OPR, :NEW.AA_MONTO_PROM_VENT, :NEW.AA_SALDO_DISPON,
         :NEW.AA_TIPO_CUENT_CUAL, :NEW.AA_FUNC_AUTORIZA, :NEW.AA_SALDO_FIN,
         :NEW.AA_COD_OFICINA, :NEW.AA_COD_OFICINA_MOD, :NEW.ROW_ADDED_DTTM, :NEW.ROW_ADDED_OPRID,
         :NEW.AV_OFICINA_ADI, :NEW.AA_ORIGEN, :NEW.AV_OFICINA_MOD, :NEW.AA_ORIGEN_MOD);
  EXCEPTION WHEN Dup_Val_On_Index THEN NULL;
/* Fin 001 */
end AV_PN_OPR_INTER_I_TGR;

/
ALTER TRIGGER "DIVISAS"."AV_PN_OPR_INTER_I_TGR" ENABLE;
--------------------------------------------------------
--  DDL for Trigger AV_PN_OPR_INTER_U_TGR
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE TRIGGER "DIVISAS"."AV_PN_OPR_INTER_U_TGR" 
/* --------------------------------------------------------------------------------------
   AUTOR     FECHA        REF COMENTARIO
   GMARTRUS  21-OCT-2009  001 Trigger que peromite guardar el historial de la tabla
   CIMA                       PS_AA_PN_OPR_INTER.
   -------------------------------------------------------------------------------------- */
  before update on PS_AA_PN_OPR_INTER
  for each row
/* Inicio 001 */
Begin
  /* Se guarda el histoico de la tabla */
  Begin
    INSERT into PS_AV_PN_O_INTER_H
           (ACTIONDTTM, APPLIED_OPRID, AV_TIP_ACCION, APPLIED_OPRID2, NRO_IDENTIDAD,TIPO_IDENTIDAD,
           AA_CIUDAD_OPR, AA_ENTIDAD_OPR, CURRENCY_CD, CURRENCY_CD_BASE, AA_AUTORIZA_DIVISA,
           DATE_END, AA_TOTAL_VENTA_USD, AA_TOTAL_VENTA_COP, AA_TOTAL_COMPR_USD, AA_TOTAL_COMPR_COP,
           ROW_LASTMANT_DTTM, ROW_LASTMANT_OPRID, AA_NRO_CUENTA, COUNTRY, AA_TIPO_CUENTA, AA_DIVISAS,
           AA_IMPORTACION, AA_EXPORTACION, AA_INVERSION, AA_GIROS, AA_ENVIO_GIROS, AA_SERVICIOS,
           AA_PRESTAMOS, AA_CTA_EXTERIOR, AA_MONTO_OPR, AA_MONTO_PROMEDIO, AA_MONTO_VENTA_OPR,
           AA_MONTO_PROM_VENT, AA_SALDO_DISPON, AA_TIPO_CUENT_CUAL, AA_FUNC_AUTORIZA, AA_SALDO_FIN,
           AA_COD_OFICINA, AA_COD_OFICINA_MOD, ROW_ADDED_DTTM, ROW_ADDED_OPRID, AV_OFICINA_ADI,
           AA_ORIGEN, AV_OFICINA_MOD, AA_ORIGEN_MOD)
    VALUES (sysdate, user, 'M', :NEW.ROW_LASTMANT_OPRID,
           :OLD.NRO_IDENTIDAD,:OLD.TIPO_IDENTIDAD, :OLD.AA_CIUDAD_OPR, :OLD.AA_ENTIDAD_OPR,
           :OLD.CURRENCY_CD, :OLD.CURRENCY_CD_BASE, :OLD.AA_AUTORIZA_DIVISA, :OLD.DATE_END,
           :OLD.AA_TOTAL_VENTA_USD, :OLD.AA_TOTAL_VENTA_COP, :OLD.AA_TOTAL_COMPR_USD, :OLD.AA_TOTAL_COMPR_COP,
           :OLD.ROW_LASTMANT_DTTM, :OLD.ROW_LASTMANT_OPRID, :OLD.AA_NRO_CUENTA, :OLD.COUNTRY, :OLD.AA_TIPO_CUENTA,
           :OLD.AA_DIVISAS, :OLD.AA_IMPORTACION, :OLD.AA_EXPORTACION, :OLD.AA_INVERSION, :OLD.AA_GIROS,
           :OLD.AA_ENVIO_GIROS, :OLD.AA_SERVICIOS, :OLD.AA_PRESTAMOS, :OLD.AA_CTA_EXTERIOR, :OLD.AA_MONTO_OPR,
           :OLD.AA_MONTO_PROMEDIO, :OLD.AA_MONTO_VENTA_OPR, :OLD.AA_MONTO_PROM_VENT, :OLD.AA_SALDO_DISPON,
           :OLD.AA_TIPO_CUENT_CUAL, :OLD.AA_FUNC_AUTORIZA, :OLD.AA_SALDO_FIN,
           :OLD.AA_COD_OFICINA, :OLD.AA_COD_OFICINA_MOD, :OLD.ROW_ADDED_DTTM, :OLD.ROW_ADDED_OPRID,
           :OLD.AV_OFICINA_ADI, :OLD.AA_ORIGEN, :OLD.AV_OFICINA_MOD, :OLD.AA_ORIGEN_MOD);
    EXCEPTION WHEN Dup_Val_On_Index THEN NULL;
  end;
/* Fin 001 */
end AV_PN_OPR_INTER_U_TGR;

/
ALTER TRIGGER "DIVISAS"."AV_PN_OPR_INTER_U_TGR" ENABLE;
--------------------------------------------------------
--  DDL for Procedure AV_CARGA_DATOS_640
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "DIVISAS"."AV_CARGA_DATOS_640" 
IS

BEGIN

FOR T IN (SELECT * FROM av_cr640_tbl
            WHERE fecha_creacion = TO_CHAR(SYSDATE -110, 'YYYYMMDD')
            OR fecha_actualizacion = TO_CHAR(SYSDATE -110, 'YYYYMMDD'))

    LOOP

      /*OPERACIONES INTERNACIONALES*/
      /*MERGE*/

      BEGIN
        INSERT INTO DIVISAS.ps_aa_pn_opr_inter (nro_identidad, tipo_identidad, aa_ciudad_opr, aa_entidad_opr,
        currency_cd)
        VALUES(T.numero_identif , T.tipo_identif , T.ciudad_cta_exterior , T.banco_cta_exterior , T.moneda_cta_exterior);
       EXCEPTION WHEN Dup_Val_On_Index THEN
       NULL;

       /* SELECT aa_entidad_opr FROM ps_aa_pn_opr_inter
        WHERE fecha_creacion = TO_CHAR(SYSDATE -200, 'YYYYMMDD')
            OR fecha_actualizacion = TO_CHAR(SYSDATE -200, 'YYYYMMDD')

        SELECT banco_cta_exterior FROM av_cr640_tbl
        WHERE fecha_creacion = TO_CHAR(SYSDATE -200, 'YYYYMMDD')
            OR fecha_actualizacion = TO_CHAR(SYSDATE -200, 'YYYYMMDD')

            UPDATE av_cr640_tbl
            SET  banco_cta_exterior = 'citigroup'

            */


       --UPDATE ps_aa_pn_opr_inter
      -- SET

       END;

       /*APROBACION SARLAFT*/


       /*INDICIOS*/


       /*EXTRACTOS*/

    END LOOP;

END;

/
--------------------------------------------------------
--  DDL for Procedure AV_CREAR__AUTORIZACIONES_DIV
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "DIVISAS"."AV_CREAR__AUTORIZACIONES_DIV" (

                                                      tipo_documento IN VARCHAR2,
                                                       nro_documento  IN VARCHAR2,
                                                     v_param_id IN VARCHAR2,
                                                     v_descr100 IN varchar2,
                                                     v_value_display IN VARCHAR2,
                                                     v_value IN VARCHAR2,
                                                     v_value_nbr IN DATE,
                                                    
                                                     v_date_added IN VARCHAR2,
                                                     v_descr in VARCHAR2,
                                                     aa_estado_autoriza IN VARCHAR2,
                                                     row_added_opprid IN VARCHAR2,
                                                    
                                                       respuesta out NUMBER)
as

v_i_number NUMBER;

begin 


IF tipo_documento <> 'N'

THEN

    select CASE WHEN COUNT(SEQ_NBR) > 0 THEN MAX(SEQ_NBR) ELSE 0 END AS M into v_i_number from DIVISAS.PS_AA_PN_OPR_INTDT  where NRO_IDENTIDAD = nro_documento;
    
    INSERT INTO DIVISAS.PS_AA_PN_OPR_INTDT
    (
    TIPO_IDENTIDAD,
    NRO_IDENTIDAD,
    SEQ_NBR,
    DATE_END,
    AA_AUTORIZA_DIVISA,
    AA_TIPO_VIGENCIA,
    AA_SOPORTE_DIVISA,
    ROW_ADDED_DTTM,
    AA_MONTO_PROM_VENT,
    AA_MONTO_PROMEDIO,
    AA_ESTADO_AUTORIZA,
    ROW_LASTMANT_DTTM,
    ROW_ADDED_OPRID,
    AA_CIUDAD_OPR,
AA_ENTIDAD_OPR,
CURRENCY_CD,
CURRENCY_CD_BASE,
AA_TOTAL_VENTA_USD,
AA_TOTAL_VENTA_COP,
AA_TOTAL_COMPR_USD,
AA_TOTAL_COMPR_COP,
AA_NRO_CUENTA,
COUNTRY,
AA_TIPO_CUENTA,
AA_DIVISAS,
AA_IMPORTACION,
AA_EXPORTACION,
AA_INVERSION,
AA_GIROS,
AA_ENVIO_GIROS,
AA_SERVICIOS,
AA_PRESTAMOS,
AA_CTA_EXTERIOR,
AA_MONTO_OPR,
AA_MONTO_VENTA_OPR,
AA_SALDO_DISPON,
AA_BLOQUEO_DIVISAS,
ROW_LASTMANT_OPRID,
AV_OFICINA_ADI,
AA_ORIGEN,
AV_OFICINA_MOD,
AA_ORIGEN_MOD

    )
    
  VALUES
  (
  tipo_documento,
    nro_documento,
    v_i_number + 1,
    v_value_nbr,
    v_descr100,
    v_value_display,
    v_value,
    sysdate,
    v_date_added,
    v_descr,
    aa_estado_autoriza,
    sysdate,
    row_added_opprid,
     ' ',
' ',
'USD',
' ',
0,
0,
0,
0,
' ',
' ',
' ',
' ',
'N',
'N',
'N',
'N',
'N',
'N',
'N',
'N',
0,
v_descr,
0,
' ',
row_added_opprid,
' ',
' ',
' ',
' '
 
   
  );
    
    
    select count(*) into respuesta from DIVISAS.PS_AA_PN_OPR_INTDT 
    where NRO_DOCUMENTO = nro_documento and SEQ_NBR = v_i_number + 1 ;
    
    
    ELSE
    
     select CASE WHEN COUNT(SEQ_NBR) > 0 THEN MAX(SEQ_NBR) ELSE 0 END AS M into v_i_number from DIVISAS.PS_AA_PJ_OPR_INTDT  where NRO_IDENTIDAD = nro_documento;
    
    INSERT INTO DIVISAS.PS_AA_PJ_OPR_INTDT
    (
    TIPO_IDENTIDAD,
    NRO_IDENTIDAD,
    SEQ_NBR,
    DATE_END,
    AA_AUTORIZA_DIVISA,
    AA_TIPO_VIGENCIA,
    AA_SOPORTE_DIVISA,
    ROW_ADDED_DTTM,
    AA_MONTO_PROM_VENT,
    AA_MONTO_PROMEDIO,
    AA_ESTADO_AUTORIZA,
    ROW_LASTMANT_DTTM,
    SETID,
AA_BANCO,
AA_CIUDAD_OPR,
CURRENCY_CD,
AA_NRO_CUENTA,
COUNTRY,
AA_TIPO_CUENTA,
AA_DIVISAS,
AA_IMPORTACION,
AA_EXPORTACION,
AA_INVERSION,
AA_GIROS,
AA_ENVIO_GIROS,
AA_SERVICIOS,
AA_PRESTAMOS,
AA_CTA_EXTERIOR,
AA_MONTO_OPR,
AA_MONTO_VENTA_OPR,
CURRENCY_CD_BASE,
AA_TOTAL_VENTA_USD,
AA_TOTAL_VENTA_COP,
AA_TOTAL_COMPR_USD,
AA_TOTAL_COMPR_COP,
AA_BLOQUEO_DIVISAS,
ROW_LASTMANT_OPRID,
AV_OFICINA_ADI,
AA_ORIGEN,
AV_OFICINA_MOD,
AA_ORIGEN_MOD,
ROW_ADDED_OPRID
   )
    
  VALUES
  (
  tipo_documento,
    nro_documento,
    v_i_number + 1,
    v_value_nbr,
    v_descr100,
    v_value_display,
    v_value,
    sysdate,
    v_date_added,
    v_descr,
    aa_estado_autoriza,
    sysdate,
    'AV001',
' ',
 ' ',
'USD',
' ',
' ',
' ',
' ',
'N',
'N',
'N',
'N',
'N',
'N',
'N',
'N',
0,
0,
0,
0,
0,
0,
0,
' ',
row_added_opprid,
' ',
 ' ',
' ',
' ',
row_added_opprid
    
   
  );
    
    
    select count(*) into respuesta from DIVISAS.PS_AA_PJ_OPR_INTDT 
    where NRO_DOCUMENTO = nro_documento and SEQ_NBR = v_i_number + 1 ;
    
    
    
    END IF;
end;

/
--------------------------------------------------------
--  DDL for Procedure AV_CREAR_AUTORIZACIONES_DIV
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "DIVISAS"."AV_CREAR_AUTORIZACIONES_DIV" (

                                                      tipo_documento IN VARCHAR2,
                                                       nro_documento  IN VARCHAR2,
                                                     v_param_id IN VARCHAR2,
                                                     v_descr100 IN varchar2,
                                                     v_value_display IN VARCHAR2,
                                                     v_value IN VARCHAR2,
                                                     v_value_nbr IN DATE,
                                                    
                                                     v_date_added IN VARCHAR2,
                                                     v_descr in VARCHAR2,
                                                     aa_estado_autoriza IN VARCHAR2,
                                                     row_added_opprid IN VARCHAR2,
                                                    
                                                       respuesta out NUMBER)
as

v_i_number NUMBER;

begin 


IF tipo_documento <> 'N'

THEN

    select CASE WHEN COUNT(SEQ_NBR) > 0 THEN MAX(SEQ_NBR) ELSE 0 END AS M into v_i_number from DIVISAS.PS_AA_PN_OPR_INTDT  where NRO_IDENTIDAD = nro_documento;
    
    INSERT INTO DIVISAS.PS_AA_PN_OPR_INTDT
    (
    TIPO_IDENTIDAD,
    NRO_IDENTIDAD,
    SEQ_NBR,
    DATE_END,
    AA_AUTORIZA_DIVISA,
    AA_TIPO_VIGENCIA,
    AA_SOPORTE_DIVISA,
    ROW_ADDED_DTTM,
    AA_MONTO_PROM_VENT,
    AA_MONTO_PROMEDIO,
    AA_ESTADO_AUTORIZA,
    ROW_LASTMANT_DTTM,
    ROW_ADDED_OPRID,
    AA_CIUDAD_OPR,
AA_ENTIDAD_OPR,
CURRENCY_CD,
CURRENCY_CD_BASE,
AA_TOTAL_VENTA_USD,
AA_TOTAL_VENTA_COP,
AA_TOTAL_COMPR_USD,
AA_TOTAL_COMPR_COP,
AA_NRO_CUENTA,
COUNTRY,
AA_TIPO_CUENTA,
AA_DIVISAS,
AA_IMPORTACION,
AA_EXPORTACION,
AA_INVERSION,
AA_GIROS,
AA_ENVIO_GIROS,
AA_SERVICIOS,
AA_PRESTAMOS,
AA_CTA_EXTERIOR,
AA_MONTO_OPR,
AA_MONTO_VENTA_OPR,
AA_SALDO_DISPON,
AA_BLOQUEO_DIVISAS,
ROW_LASTMANT_OPRID,
AV_OFICINA_ADI,
AA_ORIGEN,
AV_OFICINA_MOD,
AA_ORIGEN_MOD

    )
    
  VALUES
  (
  tipo_documento,
    nro_documento,
    v_i_number + 1,
    v_value_nbr,
    v_descr100,
    v_value_display,
    v_value,
    sysdate,
    v_date_added,
    v_descr,
    aa_estado_autoriza,
    sysdate,
    row_added_opprid,
     ' ',
' ',
'USD',
' ',
0,
0,
0,
0,
' ',
' ',
' ',
' ',
'N',
'N',
'N',
'N',
'N',
'N',
'N',
'N',
0,
v_descr,
0,
' ',
row_added_opprid,
' ',
' ',
' ',
' '
 
   
  );
    
    
    select count(*) into respuesta from DIVISAS.PS_AA_PN_OPR_INTDT 
    where NRO_DOCUMENTO = nro_documento and SEQ_NBR = v_i_number + 1 ;
    
    
    ELSE
    
     select CASE WHEN COUNT(SEQ_NBR) > 0 THEN MAX(SEQ_NBR) ELSE 0 END AS M into v_i_number from DIVISAS.PS_AA_PJ_OPR_INTDT  where NRO_IDENTIDAD = nro_documento;
    
    INSERT INTO DIVISAS.PS_AA_PJ_OPR_INTDT
    (
    TIPO_IDENTIDAD,
    NRO_IDENTIDAD,
    SEQ_NBR,
    DATE_END,
    AA_AUTORIZA_DIVISA,
    AA_TIPO_VIGENCIA,
    AA_SOPORTE_DIVISA,
    ROW_ADDED_DTTM,
    AA_MONTO_PROM_VENT,
    AA_MONTO_PROMEDIO,
    AA_ESTADO_AUTORIZA,
    ROW_LASTMANT_DTTM,
    SETID,
AA_BANCO,
AA_CIUDAD_OPR,
CURRENCY_CD,
AA_NRO_CUENTA,
COUNTRY,
AA_TIPO_CUENTA,
AA_DIVISAS,
AA_IMPORTACION,
AA_EXPORTACION,
AA_INVERSION,
AA_GIROS,
AA_ENVIO_GIROS,
AA_SERVICIOS,
AA_PRESTAMOS,
AA_CTA_EXTERIOR,
AA_MONTO_OPR,
AA_MONTO_VENTA_OPR,
CURRENCY_CD_BASE,
AA_TOTAL_VENTA_USD,
AA_TOTAL_VENTA_COP,
AA_TOTAL_COMPR_USD,
AA_TOTAL_COMPR_COP,
AA_BLOQUEO_DIVISAS,
ROW_LASTMANT_OPRID,
AV_OFICINA_ADI,
AA_ORIGEN,
AV_OFICINA_MOD,
AA_ORIGEN_MOD,
ROW_ADDED_OPRID
   )
    
  VALUES
  (
  tipo_documento,
    nro_documento,
    v_i_number + 1,
    v_value_nbr,
    v_descr100,
    v_value_display,
    v_value,
    sysdate,
    v_date_added,
    v_descr,
    aa_estado_autoriza,
    sysdate,
    'AV001',
' ',
 ' ',
'USD',
' ',
' ',
' ',
' ',
'N',
'N',
'N',
'N',
'N',
'N',
'N',
'N',
0,
0,
0,
0,
0,
0,
0,
' ',
row_added_opprid,
' ',
 ' ',
' ',
' ',
row_added_opprid
    
   
  );
    
    
    select count(*) into respuesta from DIVISAS.PS_AA_PJ_OPR_INTDT 
    where NRO_DOCUMENTO = nro_documento and SEQ_NBR = v_i_number + 1 ;
    
    
    
    END IF;
end;

/
--------------------------------------------------------
--  DDL for Procedure AV_CREAR_ENTIDADES
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "DIVISAS"."AV_CREAR_ENTIDADES" (

tipo_documento in VARCHAR2,
                                                       nro_documento  IN VARCHAR2,
                                                     v_cod_entidad IN VARCHAR2,
rowaddedoprid IN VARCHAR2,
                                                       respuesta out NUMBER)
as

v_i_number NUMBER;

begin


if tipo_documento <> 'N'

then

    select CASE WHEN COUNT(AA_SECUENCIA) > 0 THEN MAX(AA_SECUENCIA) ELSE 0 END AS M into v_i_number from DIVISAS.PS_AA_ENTI_OPRPN  where NRO_IDENTIDAD = nro_documento;

    INSERT INTO DIVISAS.PS_AA_ENTI_OPRPN
    (
    TIPO_IDENTIDAD,
    NRO_IDENTIDAD,
 
    AA_COD_ENTIDAD,
    AA_SECUENCIA,
    ROW_ADDED_OPRID,
  ROW_LASTMANT_OPRID,
  SYNCID,
  AV_OFICINA_ADI,
  AA_ORIGEN,
  AV_OFICINA_MOD,
  AA_ORIGEN_MOD,
ROW_ADDED_DTTM

   )

  VALUES
  (
  tipo_documento,
    nro_documento,
    v_cod_entidad,
    v_i_number,
    rowaddedoprid,
    rowaddedoprid,
  0,
  ' ',
  ' ',
  ' ',
  ' ',
sysdate



  );


  select count(*) into respuesta from DIVISAS.PS_AA_ENTI_OPRPN
    where NRO_DOCUMENTO = nro_documento and AA_SECUENCIA = v_i_number + 1 ;



     else


     select CASE WHEN COUNT(AA_SECUENCIA) > 0 THEN MAX(AA_SECUENCIA) ELSE 0 END AS M into v_i_number from DIVISAS.PS_AA_ENTI_OPRPJ  where NRO_IDENTIDAD = nro_documento;

    INSERT INTO DIVISAS.PS_AA_ENTI_OPRPJ
    (
    TIPO_IDENTIDAD,
    NRO_IDENTIDAD,
    SETID,
 
    AA_COD_ENTIDAD,
    AA_SECUENCIA,
    ROW_ADDED_DTTM,
    ROW_ADDED_OPRID,
    ROW_LASTMANT_DTTM,
  ROW_LASTMANT_OPRID,
  SYNCID,
  AV_OFICINA_ADI,
  AA_ORIGEN,
  AV_OFICINA_MOD,
  AA_ORIGEN_MOD

   )

  VALUES
  (
  tipo_documento,
    nro_documento,
    'AV001',
   
    v_cod_entidad,
    v_i_number,
    sysdate,
    rowaddedoprid,
    sysdate,
    rowaddedoprid,
  0,
  ' ',
  ' ',
  ' ',
  ' '




  );


  select count(*) into respuesta from DIVISAS.PS_AA_ENTI_OPRPJ
    where NRO_DOCUMENTO = nro_documento and AA_SECUENCIA = v_i_number + 1 ;


end if;

end;

/
--------------------------------------------------------
--  DDL for Procedure AV_CREAR_OPERACIONES_INT_DIV
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "DIVISAS"."AV_CREAR_OPERACIONES_INT_DIV" (

                                                      tipo_documento IN VARCHAR2,
                                                       nro_documento  IN VARCHAR2,
                                                    aa_divisas IN VARCHAR2,
                                                    aa_importacion IN VARCHAR2,
                                                    aa_exportacion IN VARCHAR2,
                                                    aa_inversion IN VARCHAR2,
                                                    aa_prestamos IN VARCHAR2,
                                                    aa_giros IN VARCHAR2,
                                                    aa_envio_giros IN VARCHAR2,
                                                    aa_servicios IN VARCHAR2,
                                                    aa_cta_exterior IN VARCHAR2,
                                                    aa_ciudad_opr IN VARCHAR2,
                                                    country IN VARCHAR2,
                                                    aa_entidad_opr IN VARCHAR2,
                                                    aa_tipo_cuenta IN VARCHAR2,
                                                    currency_cd_base IN VARCHAR2,
                                                    aa_nro_cuenta IN VARCHAR2,
                                                    aa_saldo_fin IN INTEGER,
                                                    aa_monto_prom_vent IN INTEGER,
                                                    aa_monto_promedio IN INTEGER,
                                                    aa_total_venta_usd IN INTEGER,
                                                    aa_total_compr_usd IN INTEGER,
                                                    aa_monto_opr IN INTEGER,
                                                    aa_monto_venta_opr IN INTEGER,
                                                    row_lastmant_oprid IN VARCHAR2,
                                                    row_added_oprid IN VARCHAR2,
                                                       respuesta out NUMBER)


as

begin 


IF tipo_documento <> 'N'

THEN

    
    
    INSERT INTO DIVISAS.PS_AA_PN_OPR_INTER
    (
    TIPO_IDENTIDAD,
    NRO_IDENTIDAD,
 
    AA_CIUDAD_OPR,
    AA_ENTIDAD_OPR,
    CURRENCY_CD,
    CURRENCY_CD_BASE,
    AA_AUTORIZA_DIVISA,
    DATE_END,
    AA_TOTAL_VENTA_USD,
AA_TOTAL_VENTA_COP,
AA_TOTAL_COMPR_USD,
AA_TOTAL_COMPR_COP,
ROW_LASTMANT_DTTM,
ROW_LASTMANT_OPRID,
AA_NRO_CUENTA,
COUNTRY,
AA_TIPO_CUENTA,
AA_DIVISAS,
AA_IMPORTACION,
AA_EXPORTACION,
AA_INVERSION,
AA_PRESTAMOS,
AA_GIROS,
AA_ENVIO_GIROS,
AA_SERVICIOS,
AA_CTA_EXTERIOR,
AA_MONTO_OPR,
AA_MONTO_PROMEDIO,
AA_MONTO_VENTA_OPR,
AA_MONTO_PROM_VENT,
AA_SALDO_DISPON,
AA_TIPO_CUENT_CUAL,
AA_FUNC_AUTORIZA,
AA_SALDO_FIN,
AA_COD_OFICINA,
AA_COD_OFICINA_MOD,
ROW_ADDED_DTTM,
ROW_ADDED_OPRID,
AV_OFICINA_ADI,
AA_ORIGEN,
AV_OFICINA_MOD,
AA_ORIGEN_MOD



    
    )
    
  VALUES
  (
 tipo_documento,
    nro_documento,
   
    aa_ciudad_opr,
    aa_entidad_opr,
    'USD',
    currency_cd_base,
    ' ',
    null,
    aa_total_venta_usd,
    '0',
    aa_total_compr_usd,
    '0',
    null,
    row_lastmant_oprid,
    aa_nro_cuenta,
    country,
    aa_tipo_cuenta,
    aa_divisas,
       aa_importacion ,
                                                    aa_exportacion ,
                                                    aa_inversion ,
                                                    aa_prestamos ,
                                                    aa_giros ,
                                                    aa_envio_giros ,
                                                    aa_servicios ,
    aa_cta_exterior,
    '0',
    '0',
    '0',
    aa_monto_opr,
    aa_monto_promedio,
    aa_monto_venta_opr,
    aa_monto_prom_vent,
    aa_saldo_fin,
    ' ',
    ' ',
    null,
    row_added_oprid,
    ' ',
    ' ',
    ' ',
    ' '
    
   
   
    
   
  );
    
    
    select count(*) into respuesta from DIVISAS.PS_AA_PJ_OPR_INTER 
    where NRO_IDENTIDAD = nro_documento ;
    
    
    ELSE
    
 
    INSERT INTO DIVISAS.PS_AA_PJ_OPR_INTER
    (
     TIPO_IDENTIDAD,
    NRO_IDENTIDAD,

   
    AA_CIUDAD_OPR,
    AA_BANCO,
    CURRENCY_CD,
    CURRENCY_CD_BASE,
    AA_AUTORIZA_DIVISA,
    DATE_END,
    AA_TOTAL_VENTA_USD,
AA_TOTAL_VENTA_COP,
AA_TOTAL_COMPR_USD,
AA_TOTAL_COMPR_COP,
ROW_LASTMANT_DTTM,
ROW_LASTMANT_OPRID,
AA_NRO_CUENTA,
COUNTRY,
AA_TIPO_CUENTA,
AA_DIVISAS,
AA_IMPORTACION,
AA_EXPORTACION,
AA_INVERSION,
AA_PRESTAMOS,
AA_GIROS,
AA_ENVIO_GIROS,
AA_SERVICIOS,

AA_CTA_EXTERIOR,
AA_MONTO_OPR,
AA_MONTO_PROMEDIO,
AA_MONTO_VENTA_OPR,
AA_MONTO_PROM_VENT,
AA_SALDO_DISPON,
AA_TIPO_CUENT_CUAL,
AA_FUNC_AUTORIZA,
AA_SALDO_FIN,

ROW_ADDED_DTTM,
ROW_ADDED_OPRID,
AV_OFICINA_ADI,
AA_ORIGEN,
AV_OFICINA_MOD,
AA_ORIGEN_MOD,
SETID



   )
    
  VALUES
  (
   tipo_documento,
    nro_documento,
   
   
    aa_ciudad_opr,
    aa_entidad_opr,
    'USD',
    currency_cd_base,
    'SI',
    null,
    aa_total_venta_usd,
    '0',
    aa_total_compr_usd,
    '0',
    sysdate,
    row_lastmant_oprid,
    aa_nro_cuenta,
    country,
    aa_tipo_cuenta,
    aa_divisas,
       aa_importacion ,
                                                    aa_exportacion ,
                                                    aa_inversion ,
                                                    aa_prestamos ,
                                                    aa_giros ,
                                                    aa_envio_giros ,
                                                    aa_servicios ,
    aa_cta_exterior,
    '0',
    '0',
    '0',
    aa_monto_opr,
    aa_monto_promedio,
    aa_monto_venta_opr,
    aa_monto_prom_vent,
    aa_saldo_fin,
   
    sysdate,
    row_added_oprid,
    ' ',
    ' ',
    ' ',
    ' ',
    '1'
  );
    
    
    select count(*) into respuesta from DIVISAS.PS_AA_PJ_OPR_INTER 
    where NRO_IDENTIDAD = nro_documento ;
    
    
    
    END IF;
end;

/
--------------------------------------------------------
--  DDL for Procedure CRS521D
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "DIVISAS"."CRS521D" 
IS
  i             NUMBER      := 0;
  NRO_IDENTIDAD VARCHAR(30) := '';
  SEQNBR        NUMBER      := 0;
  valorRow      NUMBER      := 0;
  valorRow2     NUMBER      := 0 ;
  DIA           NUMBER      := 0;
  MES           NUMBER      := 0;
  AO           NUMBER      := 0;
  FECHA         VARCHAR(30) := '';
  TIPODOC       VARCHAR(30) := '';
  TIPODIVISA    VARCHAR(30) := '';
  AA_MONTO_OPR1 NUMBER      := 0;
  PARTICIPATION NUMBER      := 0;
  AA_MONTO_TASA NUMBER      := 0;
  V_EXISTE      NUMBER      := 0;
  FECHA         DATE;
BEGIN
  Dbms_Output.PUT_LINE(TO_CHAR(SYSDATE, 'DD/MM/YYYY HH24:MI:SS')||' '||'1. Inicio del proceso de carga masiva de mesa de dinero.');
  Dbms_Output.PUT_LINE(TO_CHAR(SYSDATE, 'DD/MM/YYYY HH24:MI:SS')||' '||'2. Valida la correcta lectura de la tabla externa AV_DIVISAS_EXT.');
  SELECT COUNT(*)
  INTO i
  FROM AV_DIVISAS_EXT
  WHERE ROWNUM < 2;
  i           := 0;
  Dbms_Output.PUT_LINE(TO_CHAR(SYSDATE, 'DD/MM/YYYY HH24:MI:SS')||' '||'3. Lee desde la tabla externa e inserta en la tabla PS_AV_MOV_PN y PS_AV_MOV_PJ.');
  FOR T IN
  (SELECT AA_FECHA_TRAN,
    AA_TIPO_DIVISA,
    AA_MONTO_DIVISAS,
    AA_DEC_MONTO_DIV,
    CURRENCY_CD,
    AA_OFICINA_DIVISAS,
    AA_TIPO_DOC_SEG,
    AA_NRO_DOCUMENTO,
    AA_TASA_DIVISAS,
    AA_DEC_TASA_DIV
  FROM AV_DIVISAS_EXT
  )
  LOOP
    i                 := i+1;
    IF(T.AA_TIPO_DIVISA='1')THEN
      TIPODIVISA      :='C';
    ELSE
      IF(T.AA_TIPO_DIVISA='2') THEN
        TIPODIVISA      :='V';
      END IF;
    END IF;
    AA_MONTO_OPR1       := (T.AA_MONTO_DIVISAS+T.AA_DEC_MONTO_DIV)/10000;
    PARTICIPATION       := (T.AA_TASA_DIVISAS +T.AA_DEC_TASA_DIV)/10000;
    AA_MONTO_TASA       := ((T.AA_TASA_DIVISAS+T.AA_DEC_TASA_DIV)/10000)*((T.AA_MONTO_DIVISAS+T.AA_DEC_MONTO_DIV)/10000);

    BEGIN
      SELECT NUMERO_IDENTIF
      INTO V_EXISTE
      FROM CRWORK.AV_CR640_TBL
      WHERE NUMERO_IDENTIF=T.AA_NRO_DOCUMENTO
      AND TIPO_IDENTIF    = DECODE(T.AA_TIPO_DOC_SEG, 'NIT','N','CC','C','TI','T','RC','R','CE','E','PS','P');
    EXCEPTION
    WHEN NO_DATA_FOUND THEN
      V_EXISTE := 0;
    END;

    IF V_EXISTE            > 0 THEN
      IF t.AA_TIPO_DOC_SEG = 'NIT' THEN
        SELECT NVL(MAX(seq_nbr),0)
        INTO SEQNBR
        FROM ps_aa_div_mov_pj
        WHERE NRO_IDENTIDAD=T.AA_NRO_DOCUMENTO
        AND TIPO_IDENTIDAD = DECODE(T.AA_TIPO_DOC_SEG, 'NIT','N','CC','C','TI','T','RC','R','CE','E','PS','P');
        BEGIN
          INSERT
          INTO DIVISAS.PS_AA_DIV_MOV_PJ
            (
              NRO_IDENTIDAD,
              TIPO_IDENTIDAD,
              SEQ_NBR,
              AA_FECHA_TX,
              AA_TIPO_DIVISA,
              AA_MONTO_OPR,
              PARTICIPATION_PCT,
              AA_MONTO_TASA,
              CURRENCY_CD,
              AA_COD_AUTORIZ,
              SETID,
              AA_ORIGEN_MOD,
              AV_OFICINA_MOD,
              AA_ORIGEN,
              AV_OFICINA_ADI,
              ROW_ADDED_OPRID,
              ROW_LASTMANT_OPRID,
              SYNCID
            )
            VALUES
            (
              T.AA_NRO_DOCUMENTO,
              DECODE(T.AA_TIPO_DOC_SEG, 'NIT','N','CC','C','TI','T','RC','R','CE','E','PS','P'),
              SEQNBR+1,
              to_Date(T.AA_FECHA_TRAN,'dd/mm/yyyy'),
              TIPODIVISA,
              AA_MONTO_OPR1,
              PARTICIPATION,
              AA_MONTO_TASA,
              T.CURRENCY_CD,
              T.AA_OFICINA_DIVISAS,
              'AV001',
              '1',
              ' ',
              ' ',
              ' ',
              ' ',
              ' ',
              0
            );
        EXCEPTION
        WHEN Dup_Val_On_Index THEN
          Dbms_Output.PUT_LINE('Registro ya existe ' || t.AA_TIPO_DOC_SEG || T.AA_NRO_DOCUMENTO);
        END;
      ELSE

        SELECT NVL(MAX(seq_nbr),0)
        INTO SEQNBR
        FROM ps_aa_div_mov_pn
        WHERE NRO_IDENTIDAD=T.AA_NRO_DOCUMENTO
        AND TIPO_IDENTIDAD = DECODE(T.AA_TIPO_DOC_SEG, 'NIT','N','CC','C','TI','T','RC','R','CE','E','PS','P');
        INSERT
        INTO DIVISAS.PS_AA_DIV_MOV_PN
          (
            NRO_IDENTIDAD,
            TIPO_IDENTIDAD,
            SEQ_NBR,
            AA_FECHA_TX,
            AA_TIPO_DIVISA,
            AA_MONTO_OPR,
            PARTICIPATION_PCT,
            AA_MONTO_TASA,
            CURRENCY_CD,
            AA_COD_AUTORIZ
          )
          VALUES
          (
            T.AA_NRO_DOCUMENTO,
            DECODE(T.AA_TIPO_DOC_SEG, 'NIT','N','CC','C','TI','T','RC','R','CE','E','PS','P'),
            SEQNBR+1,
            to_Date(T.AA_FECHA_TRAN,'dd/mm/yyyy'),
            TIPODIVISA,
            AA_MONTO_OPR1,
            PARTICIPATION,
            AA_MONTO_TASA,
            T.CURRENCY_CD,
            T.AA_OFICINA_DIVISAS
          );
      END IF;
    END IF;
  END LOOP;
  COMMIT;
END;

/
--------------------------------------------------------
--  DDL for Procedure DATOS_640
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "DIVISAS"."DATOS_640" 

AS

BEGIN

FOR T IN (SELECT * FROM av_cr640_tbl
            WHERE fecha_creacion = TO_CHAR(SYSDATE -120, 'YYYYMMDD')
            OR fecha_actualizacion = TO_CHAR(SYSDATE -120, 'YYYYMMDD'))

    LOOP

      BEGIN
        INSERT INTO DIVISAS.ps_aa_pn_opr_inter(nro_identidad, tipo_identidad)

        VALUES(T.numero_identif, T.tipo_identif);                                                        
                               
       EXCEPTION WHEN Dup_Val_On_Index THEN
       NULL;

       END;

    END LOOP;

END;

/
--------------------------------------------------------
--  DDL for Procedure MESA_DINERO_OPERAC
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "DIVISAS"."MESA_DINERO_OPERAC" 


IS

i                  NUMBER              := 0;
NRO_IDENTIDAD        VARCHAR(30)         := '';
SEQNBR                  NUMBER              := 0;
valorRow                  NUMBER              := 0;
valorRow2                  NUMBER              := 0 ;
DIA                  NUMBER              := 0;
MES                  NUMBER              := 0;
AO                  NUMBER              := 0;
FECHA        VARCHAR(30)         := '';
TIPODOC        VARCHAR(30)         := '';
TIPODIVISA        VARCHAR(30)         := '';
AA_MONTO_OPR1                  NUMBER              := 0;
PARTICIPATION                  NUMBER              := 0;
AA_MONTO_TASA                  NUMBER              := 0;

BEGIN

  Dbms_Output.PUT_LINE(To_Char(SYSDATE, 'DD/MM/YYYY HH24:MI:SS')||' '||'10. Inicio del proceso de carga masiva de mesa de dinero.');

   Dbms_Output.PUT_LINE(To_Char(SYSDATE, 'DD/MM/YYYY HH24:MI:SS')||' '||'30. Valida la correcta lectura de la tabla externa AV_DIVISAS_EXT.');
   /*SELECT Count(*) INTO i FROM CRWORK.AV_DIVISAS_EXT WHERE ROWNUM < 2;   */

   i:= 0;

   Dbms_Output.PUT_LINE(To_Char(SYSDATE, 'DD/MM/YYYY HH24:MI:SS')||' '||'40. Lee desde la tabla externa e inserta en la tabla PS_AV_MOV_PN.');
   FOR T IN (SELECT AA_FECHA_TRAN, AA_TIPO_DIVISA, AA_MONTO_DIVISAS, AA_DEC_MONTO_DIV, CURRENCY_CD, AA_OFICINA_DIVISAS,
                    AA_TIPO_DOC_SEG, AA_NRO_DOCUMENTO, AA_TASA_DIVISAS, AA_DEC_TASA_DIV FROM CRWORK.AV_DIVISAS_EXT)
   LOOP
     i := i+1;

     /*EL id de campana se genera cuando se creen las camapanas*/
     /*v_ID_CAMPANA := ' ';  */




if(T.AA_TIPO_DIVISA='1')THEN

TIPODIVISA:='C';
else

IF(T.AA_TIPO_DIVISA='2') THEN

TIPODIVISA:='V';

END IF;

END IF;



 AA_MONTO_OPR1:= (T.AA_MONTO_DIVISAS+T.AA_DEC_MONTO_DIV)/10000;
  PARTICIPATION:= (T.AA_TASA_DIVISAS+T.AA_DEC_TASA_DIV)/10000;
  AA_MONTO_TASA:= ((T.AA_TASA_DIVISAS+T.AA_DEC_TASA_DIV)/10000)*((T.AA_MONTO_DIVISAS+T.AA_DEC_MONTO_DIV)/10000);



TIPODOC:= SUBSTR(T.AA_TIPO_DOC_SEG,1,1);

BEGIN

     select NUMERO_IDENTIF into NRO_IDENTIDAD from CRWORK.AV_CR640_TBL where TIPO_IDENTIF=TIPODOC and NUMERO_IDENTIF=T.AA_NRO_DOCUMENTO;







             IF TIPODOC='C'  THEN

                  select nvl(max(seq_nbr),0) into SEQNBR from ps_aa_div_mov_pn where NRO_IDENTIDAD=T.AA_NRO_DOCUMENTO ;

SELECT count(*) into valorRow from PS_AA_DIV_MOV_PN where NRO_IDENTIDAD=T.AA_NRO_DOCUMENTO and SEQ_NBR=SEQNBR+1;



dbms_output.put_line('valorRow PN'||valorRow);

IF( valorRow=0) THEN

        INSERT  INTO PS_AA_DIV_MOV_PN (NRO_IDENTIDAD, TIPO_IDENTIDAD, SEQ_NBR,AA_FECHA_TX,AA_TIPO_DIVISA,AA_MONTO_OPR,PARTICIPATION_PCT,AA_MONTO_TASA,CURRENCY_CD,AA_COD_AUTORIZ)
        VALUES (T.AA_NRO_DOCUMENTO, TIPODOC, SEQNBR+1,TO_DATE(T.AA_FECHA_TRAN,'DD MM YYYY'),TIPODIVISA,AA_MONTO_OPR1,PARTICIPATION,AA_MONTO_TASA,T.CURRENCY_CD,T.AA_OFICINA_DIVISAS);



            END IF;

                 ELSIF TIPODOC='N'  THEN


                    select nvl(max(seq_nbr),0) into SEQNBR from ps_aa_div_mov_pj where NRO_IDENTIDAD=T.AA_NRO_DOCUMENTO;



                     SELECT count(*) into valorRow2 from PS_AA_DIV_MOV_PJ where NRO_IDENTIDAD=T.AA_NRO_DOCUMENTO and SEQ_NBR=SEQNBR;


                          dbms_output.put_line('valorRow2'||valorRow2);


                     IF( valorRow2=0) THEN


       INSERT  INTO PS_AA_DIV_MOV_PJ (NRO_IDENTIDAD, TIPO_IDENTIDAD, SEQ_NBR,AA_FECHA_TX,AA_TIPO_DIVISA,AA_MONTO_OPR,PARTICIPATION_PCT,AA_MONTO_TASA,CURRENCY_CD,AA_COD_AUTORIZ)
        VALUES (T.AA_NRO_DOCUMENTO, TIPODOC, SEQNBR+1,TO_DATE(T.AA_FECHA_TRAN,'DD MM YYYY'),TIPODIVISA,AA_MONTO_OPR1,PARTICIPATION,AA_MONTO_TASA,T.CURRENCY_CD,T.AA_OFICINA_DIVISAS);

        END IF;

                 ELSE

                  dbms_output.put_line('NI JURIDICA, NI NATURAL');

                 END IF;







     EXCEPTION
     WHEN No_Data_Found THEN

              dbms_output.put_line('SIN DATA EN AV_CR640_TBL');

              END;


   END LOOP;

            COMMIT;




END;

/
--------------------------------------------------------
--  DDL for Function AV_CORREO_VALIDA
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE FUNCTION "DIVISAS"."AV_CORREO_VALIDA" (address IN VARCHAR2) RETURN VARCHAR2 IS
   pos NUMBER;
BEGIN
      
   IF address IS NULL THEN
      RETURN 'N';
   END IF;

   pos := InStr(address, '..', 1);
   pos := pos + InStr(address, '.@', 1);
   pos := pos + InStr(address, '@.', 1);
   
   IF pos > 0 THEN
      RETURN 'N';
   END IF;

   IF SubStr(address, 1, 1) = '.' OR SubStr(address, -1) = '.' THEN
      RETURN 'N';
   END IF; 

   if NOT REGEXP_LIKE(address, '^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$', 'i') THEN
      return 'N';
   end IF;
   return 'Y';
END;

/
--------------------------------------------------------
--  DDL for Function av_dir_valida
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE FUNCTION "DIVISAS"."av_dir_valida" (address IN VARCHAR2) RETURN VARCHAR2 IS
BEGIN
   if REGEXP_LIKE(address, '(.)*DEFINI(.)*', 'i') then
      return 'N';
   ELSIF REGEXP_LIKE(address, '^[0-9]') then
       return 'N';
   ELSIF (address = '0') then
      return 'N';
   elsif (InStr(address, '@') > 0 ) then
      return 'N';
   elsif (Upper(address) = 'NO APLICA') then
      return 'N';
   elsif (address IS NULL OR address = ' ') then
      return 'N';
   elsif (Upper(address) = 'SIN DIRECCION') then
      return 'N';
   elsif REGEXP_LIKE(Upper(address), '(.)*NO TIENE(.)*', 'i') then
      return 'N';
   elsif (Length(address) < 5) then
      return 'N';
   end IF;
   return 'Y';
END;

/
